# Computer Security

## 5장. 악성 소프트웨어 (Malicious Software)

#### 2024.10.20.(일)

### 목차

1. 악성 소프트웨어의 유형
2. 지능형 지속 위협
3. 전파: 손상된 내용, 바이러스
4. 전파: 사회 공학, 스팸 전자메일, 트로이 목마
5. 페이로드: 시스템 파괴
6. 페이로드: 공격 에이전트, 좀비, 봇
7. 페이로드: 정보 도용, 키로거, 피싱, 스파이웨어
8. 페이로드: 은신, 백도어, 루트킷
9. 대비책
10. 최신 사례 / 동향

## 5-1. 악성 소프트웨어의 유형

### 1. 악성 소프트웨어의 유형

- 악성 소프트웨어(Malware, 악성코드)의 정의
  - 컴퓨터 사용자에게 피해를 주기 위해 만든, 모든 악의적 목적을 가진 프로그램 및 매크로, 스크립트로 컴퓨터에서 작동하는 실행 가능한 모든 형태
  - 종류: 바이러스, 웜, 트로이 목마, 스파이웨어, 애드웨어, 매크로 등등

### 1. 악성 코드의 유형

- 악성 코드의 역사

  - 바이러스(Virus)

    - 자기 자신을 복제하여 대상 프로그램에 포함해서 해당 프로그램을 감염시키는 프로그램
    - 최초 바이러스는 5.25 인치 플로피디스켓의 브레인 바이러스
    - 브레인 바이러스 증상
      - 디스크 부팅시간 증가, 읽기 속도 저하, 볼륨 라벨 'Brain'으로 변경, 기억장소 크기 7KB 감소, 불량 클러스터 생성

  - 웜(Worm)

    - 다른 프로그램에 감염되어 전파되는 컴퓨터 바이러스와 달리 자체적으로 실행되어 네트워크를 통해 다른 컴퓨터로 전파가 가능함
    - 최초 웜은 1988년 미국 네트워크를 마비시킨 '모리스 웜', 인터넷을 통해 최초로 전파됨
    - 2000년대 초반 시스템 종료 메세지가 뜨는 '블랙스터 웜' 등이 대표적

  - 매크로바이러스(Macro Virus)

    - 1999년에 매크로 바이러스로 잘 알려진 멜리사(Melissa) 바이러스 출현
    - 매크로(macro): 엑셀이나 워드에서 특정한 기능을 자동화해 놓은 일종의 프로그램

  - 변종 웜의 발생
    - 2005년 3월에 MMS로 감염된 휴대전화에 저장된 전화번호로 악성 코드를 퍼뜨리는 컴워리어(CommWarrior) 등장
    - 저장 매체나 인터넷으로 전파되던 악성 코드가 휴대전화 통신망으로 전파되기 시작함

- 악성 코드의 분류

  1. 확산과 전파 기반(목표에 도달하기 위해)

  - 바이러스, 웜
  - 사회 공학, 스팸 전자메일, 트로이 목마

  2. 동작이나 페이로드 기반(목표에 도달한 후 수행)

  - 시스템 파괴
  - 공격 에이전트, 좀비, 봇
  - 정보 도용, 키로거, 피싱, 스파이웨어
  - 은신, 백도어, 루트킷

- 악성 소프트웨어 관련 용어

| 명칭 | 설명 |
| 지능형 지속 위협 (APT) | _ 다양한 침입 기술과 악성 소프트웨어를 사용 _ 상업적 또는 정치적 목적을 위해 특정 공격 대상에 지속적이며 효율적으로 적용함 _ 조직의 기밀 정보 획득을 위하여 사용됨 |
| 바이러스 (Virus) | _ 사용자의 컴퓨터 (네트워크 공유 포함) 내에서 프로그램이나 실행 가능한 부분을 몰래 변형하여 자신 또는 변형을 복사하는 프로그램 _ 가장 큰 특성은 복제와 감염이며, 다른 네트워크의 컴퓨터 스스로 전파되지 않음 |
| 트로이 목마 (Trojan) | _ 악의적인 공격자가 침투, 사용자의 컴퓨터를 조종하는 프로그램 _ 자기 자신을 다른 파일에 복사하지 않고 네트워크를 통해 전파되지 않음 (바이러스/웜과 구별) |
| 애드웨어 (Adware) | _ 소프트웨어에 통합된 광고, 팝업 광고를 포함 _ 상업 사이트로 연결하는 경로 변경으로 사용자에게 부정적인 결과를 초래할 수 있음 |
| 웜 (Worm) | _ 독립적으로 실행할 수 있고 목표 시스템에서 소프트웨어의 취약성을 이용하여 네트워크상의 다른 서버에게 자신의 복사본을 전파할 수 있는 컴퓨터 프로그램 |
| 스팸 프로그램 | 대량의 전자메일을 보내기 위하여 사용됨 |
| 스파이웨어 (Spyware) | 키스트로크, 스크린 데이터, 네트워크 트래픽 등을 모니터링하는 것에 의하여 컴퓨터로부터 정보를 수집하여 다른 시스템에 전송하는 소프트웨어 |
| 좀비-봇 (Zombi-Bot) | 다른 기계를 공격하도록 감염된 기계에서 활성화되는 프로그램 |
| 키로거 (Key logger) | 공격된 시스템으로부터 자판 입력을 수집하는 프로그램 |
| 백도어 (Backdoor) | _ 원래) 시스템의 유지, 보수나 문제 해결을 위해 시스템 관리자가 보안 설정을 우회한 다음 시스템에 접근할 수 있도록 만든 도구 _ 백도어를 악의적인 목적을 가진 공격자가 시스템에 쉽게 재침입하는데 이용하는 경우를 의미 |
| 루트킷 (Rootkit) | _ 공격자가 컴퓨터 시스템에 침입하여 루트 권한 접근을 얻은 후에 사용되는 크래킹 공격 도구의 모음 |
| 다운로드에 의한 구동 | 클라이언트 시스템을 공격하기 위하여 브라우저의 취약점을 이용하는 손상된 웹사이트에 있는 코드를 사용하는 공격 |
| 익스플로잇(Exploit) | 하나의 취약점 또는 다수의 취약점에 특화된 코드 (취약점 공격) |
| 플러더(Flooder) | _ 네트워크에 연결된 컴퓨터를 공격하기 위해 대량의 데이터를 만듦 _ 만들어진 데이터를 이용해 DoS 공격의 형태 수행 |
| 논리 폭탄 (Logic bomb) | _ 공격자에 의하여 악성 소프트웨어에 삽입된 코드 _ 특정 조건이 만족될 때까지 잠복하고 조건이 만족되면 논리 폭탄이 트리거되어 공격 동작을 실행 |
| 매크로 바이러스 | _ 전형적으로 문서에 포함된 매크로나 스크립팅 코드를 사용 \* 문서를 열거나 편집할 때 자동으로 실행됨 |
| 모바일 코드 | 다양한 장치의 플랫폼에 변경 없이 설치되어 실행되는 소프트웨어 |

## 5-2. 지능형 지속 위협 (APT)

- APT 공격이란?
  - 다양한 IT 기술과 방식들을 이용해 조직적으로 경제적인 목적을 위해 다양한 보안 위협들을 생산해 지속적으로 특정 대상에게 가하는 공격 기법
  - 지능형 지속 위협(Advanced Persistent Threat)을 의미함

1. 지능형 (Advanced)

- 각양각색의 침략 기술과 특화된 악성코드를 이용
- 여러가지 공격 요소들이 선정된 목표에 적합하도록 알맞은 공격 기술을 선택

2. 지속 (Persistent)

- 성공률을 극대화하기 위하여 오랜 시간에 걸쳐서 선정된 목표에 대한 공격
- 목표에 목적이 달성될 때까지 다양한 혀태의 공격이 점진적으로 또는 은밀하게 이루어짐

3. 위협 (Threat)

- 공격자는 보통 풍부한 자원 등을 가진 개인/조직들을 목표로 중대한 위협을 가하며,
- 주로 정보 탈취, 스파이 활동, 중요 인프라 손상 등의 목적으로 수행
- 컴퓨터 기술의 발전으로 자동화된 공격 도구와 향상된 공격기법은 위협의 수준을 증가시킴

* APT 공격은 표적 지향의 공격이기 때문에 공격방식을 규정할 수는 없지만 다수의 공격사례를 통해 7가지의 공격 요소를 도출
  - 표적시스템 인식
  - 초기 침투
  - 백도어 생성
  - 내부 인식
  - 전이
  - 임무완료
  - 숨김

1. 표적시스템 인식 (Targeted System Recognition)

- 침입 전 표적 시스템에 대한 정보 수집 활동
- 기술적인 방법은 포트 스캔을 통해서 침입 가능한 포트(Port)를 검색
- 비기술적인 방법으로는 Social engineering을 통해서 보안 정보에 접근권한이 있는 담당자의 이메일 주소 등을 획득하여 이후 Spear phishing, USB 감염 등을 위한 수단을 사용

2. 초기 침투 (Initial Intrusion)

- 실질적인 APT 공격이 이루어지는 단계로써 표적 시스템에 초기 침투를 수행
- 수집한 정보를 토대로 Spear phishing 공격을 시도
- 보안담당자, 네트워크담당자와 같은 표적 시스템을 관리하는 담당자가 주요 표적
- 공격자는 주로 악성코드에 감염된 웹사이트나 문서를 이메일에 첨부하여 표적에게 전송

3. 백도어 생성 (Backdoor Establishment)

- 최초 침입 이후 공격자는 향후에 더욱 쉽게 시스템에 접근하기 위하여 백도어를 생성
- 공격자는 자신이 생성한 C&C (Command and Control) Server와 표적 시스템이 직접적으로 정보를 교환
- 정상적인 트래픽처럼 보이는 암호화된 데이터를 C&C 서버와 주고받아 Antivirus 제품의 감시망을 벗어나 정보를 쉽게 획득

4. 내부 인식 (Internal Recognition)

- 신뢰된 컴퓨터를 통해서 네트워크 스캐닝을 시도
- 내부네트워크를 통해서 정찰이 이루어지며 신뢰되는 관계를 통해 표적 시스템의 네트워크 정보를 획득

5. 전이 (Matastasis)

- 내부 정찰을 통해서 얻은 정보를 이용하여 주요 정보가 있는 End-Point로 악성코드를 전이하며 동일 네트워크를 사용하는 모든 End-Point를 감염
- 공격자는 원하는 정보를 유출시킬 준비를 마침

6. 임무 완료 (Mission Complete)

- 공격자의 목적에 맞는 행동을 성공적으로 수행하는 단계
- 공격자의 목적은 대표적으로 시스템 파괴와 기밀 정보의 유출
- Antivirus에 탐지되지 않게 하기 위해서 정보는 암호화, 파일압축, 파일 분할 등의 기법을 사용

7. 숨김 (Hiding)

- APT 공격은 지속적인 공격을 위해서 특별한 이벤트가 없는 동안 악성 소프트웨어를 숨김
- 몇몇의 APT 공격은 Rootkit을 포함하고 있으며 이를 통해 시스템의 루트 권한을 획득
- Rootkit을 이용하여 Malware의 행동을 숨김

* APT 공격 특징

  - 특정 조직에 최적화된 공격 수행
  - 충분한 시간과 비용 투자
  - 조직 및 구성원 개인에 대한 충분한 정보 수집 (사회공학적인 방법 이용)
  - 탐지 회피 기법을 병행하여 공격 수행
    - low and slow 전략
    - 알려지지 않은 악성코드 (Zero-Day Attack) 사용
    - 이상징후를 파악하지 못하도록 장기간에 걸쳐 은밀히 활동
  - 다양한 방향으로 공격, 사용자 및 Endpoint에 집중

* APT 공격 대응 방안

- 공격자가 원하는 정보에 접근하기 까지 소요 시간 지연
  - 네트워크 분리 (망 분리)
  - 내부 시스템 인증 강화
- 공격자가 원하는 정보에 접근하기 이전 단계에서 탐지/제거
  - 알려지지 않은 악성코드(Zero-Day Attack) 탐자 / 제거
  - 악성코드/원격접속/명령 및 제어 지점 접근 트래픽 탐지/차단

* APT 공격 기법

| 관찰 | _ 공격자들은 표적으로 삼은 조직, 시스템, 프로세스, 협력업체를 포함해 사람들을 파악하기 위해 수개월에 걸쳐 공격 목표를 분석함 |
| 사회공학 | _ 공격자가 특정 조직의 내부자를 노린다면 공격자는 사전에 개인 SNS, P2P, 홈페이지 등을 검색하여 공격대상의 개인정보와 관련 키워드 등을 수집함 _ 공격자는 피싱 메일을 보내는 방식 등을 이용하여 실수나 부주의로 링크를 클릭하여 첨부된 파일을 열도록 하는 사회공학 기법을 접목시킴 |
| 제로데이 취약점 | _ 개발자들이 보안패치 등을 제공하기 전까지 소프트웨어는 특정 알려진 취약점에 대해 무방비 상태에 노출됨 |
| 수동 | _ 각각의 개별 시스템과 사람을 표적으로 삼아 고도의 정교한 수동 공격을 감행 _ 일반적인 해킹 공격에서는 효과를 극대화하기 위해 자동화를 선택하는 방식과 비교해 볼 때 대조적임 |
| 지속적인 분석 | _ 전략적인 기회를 포착하기 위해 공격자가 분석하는 활동 |
| 유출 | _ 웹 메일 혹은 암호화된 패킷이나 압축파일 형태로 공격자에게 정보를 전송 |
| 중단 | \* 소프트웨어 및 시스템의 강제 종료 또는 악의적인 시스템 중단 문제를 유발 |

## 5-3. 전파: 바이러스

### 3. 전파: 바이러스

- 바이러스의 성질

  - 프로그램을 수정하는 것에 의하여 다른 프로그램들을 감염시키는 일련의 소프트웨어

    - 원본 코드가 바이러스 코드를 복제하기 위한 루틴을 갖도록 수정함
    - 바이러스 코드는 다른 내용을 감염시키는데 계속 사용될 수 있음
    - 초기 감염 형태는 의심되지 않는 사용자들로부터 프로그램, 디스크 파일, USB 스틱을 상호 교환하는 것에 의하여 컴퓨터에서 컴퓨터로 전염
    - 인터넷의 보편화로 네트워크를 통해서도 전염됨

  - 실행할 수 있는 프로그램에 첨부된 바이러스는 프로그램에 허용된 어떠한 것이든 가능

  - 바이러스 코드가 실행되면 사용자의 권한에 의해 허용된 파일이나 프로그램 삭제 등 다양한 기능 수행

- 컴퓨터 바이러스의 유형

1. 감염 메커니즘

- 바이러스가 퍼지거나 전파하는 수단으로서 감염 벡터로 표현

2. 트리거

- 논리폭탄 (logic bomb) 공격
- 페이로드가 활성화하거나 전달될 때를 결정하는 이벤트 혹은 조건

3. 페이로드

- 바이러스를 수행하는 부분
- 손상을 포함할 수 있음

* 많은 악성코드의 형태는 각 부분에 하나 이상의 변형을 포함

* 바이러스의 수행 4단계 (휴지-전파-트리거-실행)

1. 휴지 단계

- 바이러스는 활성화되지 않음
- 바이러스는 날짜, 다른 프로그램이나 파일의 생성, 디스크 용량의 초과 등과 같은 특정한 사건에 의하여 활성화됨
- 모든 바이러스가 휴지단계를 거치는 것은 아님

2. 전파 단계

- 바이러스는 자신을 복제하여 다른 프로그램 또는 디스크 상의 시스템 영역에 삽입
- 바이러스는 탐지를 피하기 위하여 변형되어 복제된 바이러스는 복제 이전의 바이러스와 같지 않을 수 있음
- 감염된 프로그램은 바이러스의 복제를 실행하고 다시 전파 단계로 들어감

3. 트리거 단계

- 바이러스는 의도한 기능을 수행하도록 설정
- 휴지 단계에서처럼 다양한 시스템 사건에 의하여 활성화
- 바이러스가 자기 자신을 복제하는 경우도 하나의 사건으로 포함

4. 실행 단계

- 바이러스 내의 의도한 기능이 수행
- 시스템 무해한 실행 - 단순히 스크린에 메세지(광고) 실행
- 손상 - 데이터 파일과 프로그램 등 파괴

* 실행 가능한 바이러스 구조
  - 전통적인 실행 코드 바이러스는 어떤 실행 프로그램의 열에 또는 뒤에 붙여질 수 있거나 다른 형태로 삽입될 수 있음
  - 코드의 첫 번째 줄은 바이러스에 의해 잠재적인 피해 프로그램이 이미 그 바이러스에 감염되었는지 안되었는지 결정하기 위해 사용되는 특별한 표시
  - 프로그램이 시작될 때 제어 권한은 우선적으로 바이러스 코드를 포함한 주요한 활동 영역으로 옮겨짐
  - 바이러스는 우선적으로 감염되지 않은 실행 파일을 찾고 그 파일을 감염시킴
  - 요구되는 트리거 조건이 만족된다면 바이러스는 페이로드를 실행
  - 바이러스는 활성화 된 후에 원래 프로그램으로 제어 권한을 옮김

[간단한 바이러스의 발견을 어렵게 하는 방법]

- 감염과 비감염 버전이 동일한 길이를 갖도록 실행파일을 압축

* 프로그램은 시간 t0에서 시작

* P1은 바이러스 CV에 감염된 프로그램이고, P2는 CV에 감염되지 않은 깨끗한 프로그램

* P1이 실행될 때 제어는 바이러스로 이동되고 다음의 단계를 수행

  - t1: 감염되지 않은 파일 P2에 대하여 바이러스는 우선 원래의 프로그램보다 바이러스 크기만큼 짧은 P'2 파일을 만들기 위해 압축함
  - t2: 복사된 CV를 압축된 프로그램 앞에 붙임
  - t3: 감염된 원래의 프로그램의 압축 버전(P'1)은 압축하지 않음
  - t4: 압축되지 않은 원래의 프로그램 P1이 실행됨

* 바이러스는 전파되며, 하나 이상의 페이로드를 포함함

* 바이러스가 단일 프로그램을 감염시킴으로써 시스템 접근하면

  - 감염된 프로그램이 실행될 때 감염된 프로그램이 접근 승인에 따라
  - 잠재적으로 그 시스템 일부 또는 모두 실행 파일이 감염됨

* 바이러스 분류

  - 표적에 의한 바이러스 분류

    1. 부트 섹터 감염자

    - 마스터 부트 레코드 또는 부트 레코드에 감염되고, 시스템이 바이러스를 포함하고 있는 디스크에서 부팅할 때 전파됨

    2. 파일 감염자

    - 운영체제 또는 쉘이 실행하기 위한 파일을 감염시킴

    3. 매크로 바이러스

    - 응용프로그램에 의해서 해석되어진 매크로 또는 스크립트 코드를 갖는 파일을 감염시킴

    4. 다중 부분 바이러스

    - 여러 가지 방법을 혼합하여 파일을 감염시킴
    - 여러 종류의 파일을 대상으로 함

  - 은닉 전략에 의한 바이러스 분류

    1. 암호화 바이러스

    - 내용을 모호하게 하기 위해 암호화를 사용하는 바이러스 형태
    - 바이러스의 일부분은 바이러스의 나머지 부분을 암호화하는 임의의 암호키를 생성
    - 키는 바이러스와 함께 저장됨

    2. 스텔스 바이러스

    - 소프트웨어 의한 감지로부터 숨기도록 설계된 바이러스 형태

    3. 다형성 바이러스

    - 바이러스 검사 프로그램을 격파시키기 위해서 기능적으로 동일하지만 다른 비트 패턴을 가진 사본을 생성

    4. 변성 바이러스

    - 다형성 바이러스와 같이 모든 감염을 변화시킴
    - 검출의 어려움을 증가시키면서 다수의 형질 전환 기술을 이용하여, 변성 바이러스를 각각의 반복에서 완전히 재기록 함

* 매크로 및 스크립팅 바이러스

  - 1990년대 중반에 매크로와 스크립트 코드 바이러스가 가장 널리 퍼짐
  - 문서 형태의 다양한 활성 콘텐츠를 지원하는 데 사용되는 스크립트 코드를 감염시킴
  - 워드 프로세싱 문서 및 파일의 다른 유형에서 임베디드, 매크로 언어의 스크립트를 사용하여 활성 콘텐츠를 지원하는 자점이 있음
  - 일반적으로 사용자는 반복적인 작업을 자동화하기 위하여 매크로를 사용하고 키 입력을 저장
  - 동적 콘텐츠, 형태 검증, 이들 문서와 연관된 다른 유용한 작업을 지원하기 위해 사용됨

* 매크로 및 스크립팅 바이러스

1. 매크로 바이러스는 플랫폼 독립적임

2. 많은 매크로 바이러스는 Microsoft Word 문서, Microsoft Office 문서에서 매크로나 Adobe PDF 문서에서의 스크립트 코드와 같이 일반적으로 사용되는 응용의 활성 내용을 감염시킴

3. 응용프로그램을 지원하는 하드웨어 플랫폼 및 운영체제에 감염시킴

4. 매크로 바이러스는 실행 코드가 없는 문서에 감염시킴

5. 컴퓨터 문서는 일반적으로 공유되어 사용되기 때문에 매크로 바이러스는 전자메일 등을 통해 쉽게 확산됨.

6. 매크로 바이러스는 시스템 프로그램보다는 사용자 문서를 감염시키기 때문에 기존의 파일 시스템 액세스 제어는 전파를 방지하는 데 제한적임

## 5-4. 전파: 사회 공학, 스팸 전자메일, 트로이 목마

### 4. 전파: 사회 공학, 스팸 전자메일, 트로이 목마

- 스팸 전자메일

  - 대부분 최신 스팸은 사용자 시스템이 사용하는 봇넷 이용 (일부 스팸은 합법적인 메일 서버로부터 보내짐)

  - 피싱 공격과 악성코드를 전파하는 주요 수단

  - 사용자의 시스템 상에 악성코드를 설치하기 위해 보내는 파일의 소프트웨어 취약성 이용

  - 사용자를 온라인 은행 사이트와 같은 합법적인 사이트로 가장하여 가짜 웹사이트로 연결시키고, 이를 이용하여 사용자의 로그인 정보와 비밀번호를 알아냄

  - 사용자에게 전자메일과 첨부 파일을 볼 것인지 또는 프로그램을 수행할 것인지에 대한 적극적인 선택을 요구

- 트로이 목마 (Trojan horse)

  - 원하지 않거나 해로운 기능을 행하는 숨겨진 코드를 포함한 프로그램이나 유틸리티
  - 공격자들이 직접적으로 수행하지 않고 간접적으로 기능을 수행하기 위하여 사용
  - 제작자는 게임이나 유용한 유틸리티 프로그램, 배포되는 사이트, 앱 스토어 등 잘 알려진 소프트웨어를 이용하여 실행하도록 유도
  - 사용자의 도움 없이 자동으로 설치 및 실행되기 위하여 소프트웨어의 취약성을 이용함
  - 자기 복제를 하지 않음
  - 트로이 목마의 세 가지 공격 형태

  1. 원래 프로그램 기능의 수행을 계속하면서 분리된 악의적인 행동을 추가적으로 수행
  2. 원래 프로그램 기능 수행을 계속하지만 악의적인 행동을 수행하기 위하여 업데이트를 통해 기능을 수정 또는 다른 악의적인 행동을 추가
  3. 원래 프로그램의 기능을 완벽하게 대치하여 악의적인 기능 수행

- 모바일 트로이목마 (Mobile phone trojans)
  - Skuller이 발견하였으며 2004년에 처음 출현
  - 이동식 웜과 같이 주 목표 디바이스는 스마트폰
  - 아이폰 O/S의 여러 버전은 그래픽 유형이나 PDF 취약성을 이용
  - 휴대전화의 잠금 장치를 해제시키는 주된 수단으로 이용

## 5-5. 페이로드: 시스템파괴

### 5. 페이로드: 시스템 파괴

- 악성 소프트웨어가 목표 시스템상에서 활성화되면 다음 관심은 이 시스템상에서 어떤 활동을 할 것인가임

- 몇몇 악성 소프트웨어는 비존재 또는 비활동적인 페이로드이고, 이것의 목적은 감염 대상을 확산 시키는 것임

- 많은 바이러스와 웜에서 보여준 초창기의 페이로드는 트리거의 조건이 만족될 때 감염된 시스템의 데이터 파괴 수행함

- 사용자 시스템 상에 원하지 않는 메세지나 내용을 보여주거나 더 심각하게는 다른 변종이 시스템상에 대한 손상을 입힘

- 페이로드의 주 동작은 컴퓨터 시스템의 소프트웨어, 하드웨어 또는 사용자 데이터의 무결성을 공격함

- 페이로드는 바로 발생하지는 않을 수도 있지만 특별한 트리거 조건이 부합될 때 활성화됨

- 데이터 파괴

  - 체르노빌 바이러스 (Chernobyl virus)

    - 윈도우 95, 98의 메모리상에서 기생하면서 데이터를 파괴시키는 초창기의 예
    - 1998년에 처음 발견되었으며, 감염은 파일을 열 때 실행
    - 트리거 데이터가 도착할 때 감염된 시스템상의 하드디스크의 처음 수 megabyte에 0의 데이터를 쓰는 것에 의해 원 데이터 삭제
      - 궁극적으로는 전체 파일시스템의 파괴를 초래

  - Klez mass-mailing warm

    - 윈도우 95가 XP 시스템을 감염시키는 파괴적인 웜의 초창기 예
    - 2001년 10월에 처음 발생하였고, 전자메일 주소를 주소록이나 시스템상의 파일 등에서 복사하여 퍼뜨림
    - 안티 바이러스 프로그램의 실행을 멈추거나 삭제할 수도 있음

  - 랜섬 웨어 (Ransomware)
    - 사용자의 데이터를 암호화하여 이 정보를 복구하는 데 필요한 키를 받는 대가로 돈을 요구함
      예) Cyborg Trojan (1989), Gpcode Trojan (2006)

- 시스템과 하드웨어 손상

  - 목표: 시스템 파괴 페어로드의 변종은 물리적인 장치의 손상
  - 체르노빌 바이러스는 데이터를 파괴할 뿐만 아니라 컴퓨터를 부팅하는데 사용되는 BIOS 코드에 중복 쓰기를 시도

    - BIOS 칩을 다시 프로그램하거나 교체될 때까지 시스템을 사용 불가

  - Stuxnet 웜은 특수 산업 제어 시스템 소프트웨어를 목표로 함
    - 제어 시스템이 감염되었다면
      제어 시스템이 정상적으로 동작할 수 없도록 원래의 시스템 소프트웨어를 다른 코드로 변경시켜서 부착된 장비의 고장을 초래

- 논리 폭탄 (Logic Bomb)
  - 데이터 파괴 악성 소프트웨어의 주요 구성 요소
  - 조건이 만족되었을 때 폭발하는 악성 소프트웨어에 내장되어 있는 코드
  - 논리 폭탄에 트리거로써 사용될 수 있는 조건의 예
    - 시스템 상에서 파일 또는 장치의 존재 또는 부재
    - 특정 날짜 혹은 업데이트 시기
    - 특정 소프트웨어의 구성 요소 실행
    - 응용프로그램을 실행하는 특정 사용자
  - 트리거가 되면 데이터나 파일 전체를 변경시키거나 삭제하여 기계를 다운시키거나 손상 초래할

## 5-6. 페이로드: 공격 에이전트, 좀비, 봇

### 6. 페이로드: 공격 에이전트, 좀비, 봇

- 좀비 / 봇

  - 공격자의 사용에 대하여 감염 시스템의 컴퓨팅이나 네트워크의 자원을 개조하는 악성 소프트웨어

- 비밀리에 다른 인터넷이 부착된 컴퓨터를 인수한 뒤 그 컴퓨터를 다른 공격을 관리하거나 시작하는데 사용

- 다른 매개체를 이용하므로 추적하기 어려움

- 로봇은 평범한 제 3자를 통해 수백 또는 수천 대의 컴퓨터에 이식

- 봇넷(botnet): 로봇 무리가 상호작용 방식으로 행동하는 집합

- 감염된 시스테의 무결성과 가용성을 공격

- 봇의 사용

  - 봇의 용도

    1. 분산 서비스 거부(DDoS) 공격

    - 사용자에 대한 서비스의 손실을 야기하는 컴퓨터 시스템 또는 네트워크에 대한 공격

    2. 스팸

    - 봇 넷 또는 수천의 봇의 도움으로 공격자는 대량의 스팸 메일 발송

    3. 스니핑 트래픽

    - 봇은 타협된 시스템에 의해 통과된 관심 텍스트 데이터를 보고 전송하기 위하여 패킷 스니퍼를 이용
    - 스니퍼: 이름, 비밀번호 등 민감한 정보 검색을 위해 사용

    4. 로깅

    - 타협된 시스템이 암호화된 통신 채널(예: HTTPS, POP3S)을 사용할 경우, 희생 컴퓨터의 네트워크 패킷은 패킷을 해독하는 적절한 키가 없기 때문에 쓸모가 없음
    - 감염된 컴퓨터에 키 입력을 캡쳐하는 키 로거를 사용
    - 공격자는 공격대상의 기밀한 정보를 검색할 수 있음

    5. 새로운 악성 소프트웨어 전파

    - 봇넷은 새로운 봇을 전파하는데 사용
    - 모든 봇들은 HTTP나 FTP를 통해 파일을 다운받아 실행하는 메커키즘을 구현하기 때문에 전파가 매우 쉬움
    - 웜과 메일 바이러스의 전진 기지로서 동작하는 10,000개의 호스트를 가진 봇넷은 더 빨리 전파하여 더 많은 해를 입힘

    6. 광고 추가 및 BHO (Brower Helper Object) 설치
       동작원리

       - 가짜 웹사이트에 광고를 설정
       - 웹사이트의 운영자는 광고 클릭에 대해 지불하도록 일부 호스팅 업체와 계약을 맺기도 함
       - 봇넷의 도움으로 이런 클릭이 수천 개의 봇이 팝업을 클릭하도록 자동화

    7. IRC (Internet Relay Chat) 채팅 네트워크 공격

       - 클론공격: 봇넷은 인터넷 릴레인 채팅(IRC)에 대한 공격에 사용
       - 피해자는 복제된 봇에 의해 수천 개의 봇이나 수천 번의 채널 요구에 의하여 트래픽이 폭증
       - 피해 IRC 네트워크는 DDoS 공격과 유사하게 마비 초래

    8. 온라인 설문/게임 조작
       - 봇넷으로부터 조작하기 쉬움
       - 각각의 봇은 다른 IP 주소를 가지고 있기 때문에 모든 투표는 진짜 사람이 투표를 한 것과 같은 신뢰성을 가짐

- 원격 제어 기능

  - (웜은 자기 스스로 전파하고 활성화)
    봇은 명령 및 제어 서버 (C&C: Command and Control Server) 네트워크에 의해 제어됨

  - 원격 제어 기능의 초기 수단: IRC 서버가 사용

  - 모든 봇은 이 서버의 특정 채널에 가입하고 명령으로써 들어오는 메세지를 처리함

  - 최근 봇넷은 IRC 기법을 피하고 HTTP와 같은 프로토콜을 통해 비밀 통신 채널을 사용

  - 제어 모듈이 인터넷의 특정 위치로부터 악성 파일을 다운로드하고 실행하도록 봇에게 지시하는 변경된 명령어 발생

-> DDoS 공격을 받은 웹사이트는 접속 불능 상태에 빠지게 됨

## 5-7. 페이로드: 정보 도용, 키로거, 피싱, 스파이웨어

### 7. 페이로드: 정보 도용, 키로거, 피싱, 스파이웨어

- 자격 증명 도난, 키로거, 스파이웨어

  - 사용자는 네트워크 패킷의 모니터링에 의해 캡쳐되는 것을 보호하기 위해 암호화된 통신 채널(HTTPS, POP3S)을 이용

  - 금융, 게임 및 관련 사이트에 자신의 로그인 및 비밀번호 자격 증명을 보냄

  - 공격자는 감염된 컴퓨터에 중요 정보를 모니터링할 수 있도록 감염된 시스템에 키 누름을 캡쳐할 수 있는 키로거를 설치

  - 이것은 감염된 시스템에 입력된 모든 텍스트의 사본을 수신하기 때문에 키로거는 전형적으로 원하는 키워드에 가까운 정보만을 반환하도록 필터링 기법을 구현 (예: "로그인", "비밀번호", "paypal.com")

  - 키로거 사용의 대처: 일부 은행 및 다른 사이트들은 패스워드와 같은 중요한 정보를 그래픽 애플릿을 사용하여 전환

- 피싱 및 신원 도용

  - 초기) 사용자의 로그인 및 패스워드 인증 정보 수집을 위해 사용
  - 최근) 사적 / 개인적인 정보를 수집하기 위하여 사용
  - 공격자는 가짜 웹사이트로 연결되는 스팸 메일의 URL을 포함시킴
  - 스팸 메일은 가짜 웹사이트로 사용자를 유도하거나 밀봉된 형식을 작성하여 호기심을 자극하여 접근하도록 함
  - 피싱 공격
    - 충분한 정보가 주어지면, 공격자는 다른 자원에 대한 신용이나 민감한 접근을 얻을 목적으로 사용자의 신원을 추측
    - 신뢰할 수 있는 주체로 가장하여 사용자의 신뢰를 활용하는 사회공학적 기법을 이용

- 정찰, 간첩 및 데이터 빼오기
  - 자격 증명 및 신용 도용은 보다 일반적인 정찰 페이로드의 특별한 경우임
  - 목표: 원하는 유형의 정보를 획득하여 공격자에게 반환
  - 2009년에 기술, 보안 및 방위 계약 회사 시스템 내의 소스코드 스토리지에 접근하기 위해 트로이 목마를 사용
  - APT 공격은 공격자의 목표 조직 및 개인으로부터 대량의 정보가 손실되는 결과를 초래할 수 있음

## 5-8. 페이로드: 은신, 백도어, 루트킷

### 8. 페이로드: 은신, 백도어, 루트킷

- 백도어

  - 트랩도어라고 알려져 있으며, 평소의 보안 접속 절차를 통하지 않고 접속을 허용하는 지점
  - 유지 관리 후크: 프로그래머는 수년 동안 프로그램을 디버그하고 시험하기 위하여 백도어를 사용
  - 백도어를 두는 이유: 프로그램을 신속하게 디버그 하기 위해 개발자가 특수한 특권을 얻거나 모든 설정과 인증을 회피하는 것을 선호
  - 부도덕적인 외부자가 인증되지 않은 접속을 위하여 백도어를 사용할 때 매우 위협적임
  - 악의적인 백도어의 사용: 백도어는 공격자가 감염된 시스템에 연결하고 명령을 내릴 수 있는 비표준 포트의 네트워크 서비스를 도청하는데 사용

- 루트킷
  - 가능한 최대의 범위까지 증거를 숨기면서 관리자의 권한으로 해당 시스템에 대한 은밀한 접속을 유지하려는 시스템에 설치된 프로그램의 집합
  - 공격자는 루트에 접속해서 시스템을 완전히 제어하고 프로그램과 파일, 모니터 프로세스를 추가하거나 수정 가능
  - 네트워크 트래픽 위조 및 변조가 가능하며 백도어에 접속 가능
  - 공격자는 자신의 존재를 숨기기 위하여 시스템에 변화를 줌으로써 사용자에게 루트킷의 존재와 루트킷이 무엇을 변화시켰는지 알기 어렵게 함
  - 숨기는 방법으로는 백신프로그램의 프로세스, 파일, 컴퓨터의 레지스트리 탐색 및 보고하는 것에 대한 기법을 파괴

* 루트킷의 특성에 따른 공격 유형

  1. 지속성

  - 매번 시스템을 부팅시킴
  - 레지스트리 또는 파일 시스템과 같은 지속적인 저장소 안의 코드를 저장 시키고, 코드는 사용자의 간섭 없이 실행되는 방법을 구현
  - 지속적인 저장소를 스캔하는 것에 의하여 쉽게 감지될 수 있음

  2. 메모리 기반

  - 지속적인 코드를 가지지 않아서 재시동으로 생존할 수 없음
  - 메모리에 있기 때문에 감지하기 어려움

  3. 사용자 모드

  - API에 대한 호출을 가로채서 반화된 결과를 수정
    예) 응용프로그램이 디렉터리 도청을 실행할 때 반환된 결과는 루트킷과 관련된 파일을 식별하는 항목을 포함하지 않음

4. 커널 모드

- API로 가는 호출을 가로챌 수 있음
- 활성 프로세스의 커널 목록에서 제거하여 악성 소프트웨어의 존재를 숨길 수 있음

5. 가상 기계 기반

- 루트킷의 가상 기계 기반 타입은 가벼운 가상 기계 모니터를 설치하고, 가상 기계에서 운영체제를 실행
- 가상화된 시스템에서 발생하는 상태 및 사전을 투명하게 가로채고 수정

6. 외부 모드

- 악성 소프트웨어는 목표 시스템의 정상적인 운영 모두 바깥 (BIOS 혹은 시스템 관리 모드)에 위치하여 하드웨어에 직접적으로 접근할 수 있음

* 커널 모드 루트킷

  - 최근 탐지를 더 어렵게 하기 위하여 커널 내부를 변화시키고 운영체제 코드와 공존하도록 발전하였음
  - 사용자 계층에서 동작하는 프로그램은 시스템 호출을 통해 커널과 상호 연동하기 때문에 프로그램의 시스템 호출 기능은 은폐하려는 커널 계층 루트킷의 주요 목표 대상임
  - 커널 루트킷의 동작 과정

    1. 각 시스템 호출은 유일한 시스템 호출 번호가 할당
    2. 사용자 모드 프로세스가 시스템 호출을 실행할 때 프로세스는 호출 번호에 의하여 시스템 호출
    3. 커널은 시스템 호출 루틴당 하나의 엔트리를 지닌 시스템 호출 테이블을 관리
    4. 각 엔트리는 관련된 루틴에 대한 포인터를 포함
    5. 시스템 호출 번호는 시스템 호출 테이블에서 색인으로써 사용

  - 시스템 호출을 변경시키는 기술 3종류

    - 시스템 호출 테이블 변경 (선택된)
      - 공격자는 시스템 테이블에 저장된 선택된 시스템 호출 주소를 변경
      - 합법적인 루틴이 루트킷으로 대치된 것으로 시스템 호출이 가능

  - 시스템 호출 테이블 대상 변경

    - 공격자는 악성 코드로 선택된 합법적인 시스템 호출 루틴을 덮어씀
    - 시스템 호출 테이블은 변경되지 않음

  - 시스템 호출 테이블 바꿈 (전체)
    - 공격자는 전체 시스템 호출 테이블을 새로운 커널 메모리 위치에 새로운 테이블을 참조하도록 변경

* 가상 기계와 기타 루트킷
  - 최근의 루트킷은 공격 대상의 운영체제에서 완전히 노출되지 않는 코드를 사용
  - 로그나 절충된 가상 기계 모니터 혹은 최근의 프로세서가 제공하는 하드웨어 가상화의 도움을 받는 하이퍼바이저를 사용하여 공격 가능
  - 루트킷 코드는 대상 운영체제에서 커널 코드의 노출 아래에서 동작하고, 가상 기계에서 알려지지 않도록 동작하여 몰래 감시하고 공격 가능
  - 방어) 모든 부트 프로세스는 반드시 보호되어야 함
    운영체제는 부트 프로세스를 안전하게 로드하고 악성코드의 설치를 못 하도록 하여야 함

## 5-9. 대비책

### 9. 대비책

- 악성 소프트웨어 대비 접근 방법

  - 목표) 악성 소프트웨어가 시스템에 설치되는 것을 허용하지 않거나 시스템의 수정 능력을 차단하는 것
  - 감염 방지가 악성코드 공격에 대한 성공의 수를 크게 줄일 수 있을지라도 일반적으로 거의 달성 불가능함
  - 예방 정책, 인식, 취약성 완화, 위협 완화
  - 대비책
    1. 시스템에 악용될 수 있는 취약점의 수를 줄이기 위하여 모든 시스템이 현재의 상태에 있도록 확인
    2. 잠재적으로 감염 또는 손상된 파일의 수를 줄이기 위하여 시스템에 저장된 프로그램 및 데이터에 대한 적절한 접근 제어를 설정
    3. 적절한 사용자 인식 및 교육을 이용하여 대비
  - 예방에 실패하면 기술적인 기법이 다음의 위협 완화를 지원하는 데 사용 가능

    1. 감지: 감염이 발생하면 감염 여부를 결정하고 악성코드의 위치를 알아냄
    2. 식별: 감지되면 시스템을 감염시킨 특정 악성코드를 식별함
    3. 제거: 특정 악성코드가 식별되면 더 확산되지 않도록 모든 감염된 시스템으로부터 악성 바이러스의 정 모든 흔적을 제거함

  - 검출에 성공했지만 식별 또는 제거할 수 없는 경우 감염 또는 악성 파일을 삭제하고 감염되지 않는 백업 버전을 다시 복구

  - 심각한 감염의 경우에는 모든 저장 공간을 깨끗하게 소각하고 깨끗한 미디어로부터 감염 시스템을 재구성

  - 효과적인 악성코드 대비책에 대한 요구 사항
    1. 일반성
    - 접근 방식은 다양한 공격을 다룰 수 있어야 함
    2. 적시성
    - 접근 방식은 감염된 프로그램이나 시스템의 수를 제한하기 위하여 빠르게 대응
    3. 회복 탄력성
    - 접근 방식은 악성코드의 존재를 숨기기 위해 공격자에 의하여 사용된 기술에 대하여 대응할 수 있어야 함
    4. 최소 DOS 비용
    - 접근 방식은 대응 소프트웨어에 의해 용량이나 서비스에 대한 최소한의 감소를 초래하여야 하며 정상적인 작동을 현격히 낮추어서는 안됨
    5. 투명성
    - 대비 소프트웨어와 장치는 기존의 OS, 응용소프트웨어, 하드웨어의 수정을 요구하지 않아야 함
    6. 전역과 지역 범위
    - 접근 방식은 기업 네트워크의 외부와 내부 모두로부터 공격원을 다룰 수 있어야 함

- 호스트 기반 스캐너

  - 소프트웨어가 목표가 된 시스템과 상호 작용을 하는 악성 소프트웨어의 행동뿐만 아니라 악성 소프트웨어 활성을 위하여 정보에 대한 최대의 접근을 제공

  - 안티바이러스 소프트웨어의 4세대 구분
    - 1세대: 간단한 스캐너
      - 악성 소프트웨어를 식별하기 위하여 악성 소프트웨어 시그니쳐가 필요
      - 시그니쳐는 "와일드카드"를 포함하지만 악성 소프트웨어의 모든 사본에서 필수적으로 동일한 구조 및 비트 패턴과 일치함
      - 이러한 시그내쳐 특정 스캐너는 알려진 악성 소프트웨어의 탐지에만 제한적임
    - 2세대: 경험적 스캐너
      - 특정 시그니쳐에 의존하지 않음
      - 가능한 악성 소프트웨어를 검색하기 위하여 경험적 규칙을 사용함
      - 스캐너는 악성 소프트웨어와 관련된 코드의 조각을 찾음
      - 키가 발견되면 스캐너는 악성 소프트웨어를 밝혀내기 위해 악성 소프트웨어를 복호화하여 감염 프로그램을 제거한 후 프로그램을 서비스에 반환
      - 체크섬(checksum)이 각 프로그램에 추가될 수 있음
      - 악성 소프트웨어가 체크섬의 변경 없이 프로그램이 대체되거나 변경된다면 무결성 검사가 이러한 변화를 잡아낼 수 있음
      - 프로그램이 변경될 때 체크섬을 바꿀 만큼 충분히 복잡한 악성 소프트웨어에 대응하기 위하여 암호화 해시 함수를 사용할 수 있음
      - 간단한 체크섬 대신에 해시 함수를 이용하여 악성 코드가 이전과 동일한 해시 코드를 생성하기 위해 프로그램을 조정하는 것을 방지할 수 있음
      - 신뢰할 수 있는 위치의 프로그램 보호 목록이 유지된다면 접근 방법으로 로그 코드나 프로그램을 대치하거나 설치하려는 시도를 탐지할 수 있음
    - 3세대: 활성 트랩
      - 감염된 프로그램의 구조보다는 행동에 의해 악성 소프트웨어를 식별하는 메모리 상주 프로그램
      - 다양한 배열에 대한 시그내쳐 및 경험적 방법의 개발이 필요 없다는 장점이 있음
    - 4세대: 완전한 기능을 갖춘 보호
      - 다양한 안티바이러스 기술로 이루어진 패키지
      - 시스템에 침투하는 악성코드의 능력을 제한하고 전파하기 위해 파일을 업데이터하는 악성 소프트웨어의 능력을 제한함

- 호스트 기반 스캐너 - 일반적 복호(GD)

  - 일반적 복호(Generic Decryption: GD) 기술
    빠른 스캐닝 속도를 유지하면서 안티바이러스 프로그램이 복잡한 다형성 바이러스와 다른 형태의 컴퓨터 악성 프로그램을 쉽게 검출

  - 다형성 바이러스가 포함된 파일이 실행될 때 바이러스가 활성화되기 위하여 자신을 복호화해야 함

  - 이런 구조를 검출하기 위하여 실행 파일은 다음 요소를 포함하는 일반적 복호 스캐너를 통하여 실행됨

    - CPU 에뮬레이터
      - 소프트웨어 기반 가상 컴퓨터, 실행 파일의 명령어는 프로세서에 의해 실행되기 보다는 에뮬레이터에 의하여 해독됨
    - 바이러스 시그니쳐 스캐너
      - 알려진 악성 시그니쳐를 찾는 목표 코드를 스캔하는 모듈임
    - 에뮬레이션 제어 모듈
      - 목표 코드의 실행을 제어함

  - 시뮬레이션의 시작에서 에뮬레이터는 목표 코드에 있는 명령어를 한 번에 하나씩 해독하기 시작함

  - 코드가 복호화 루틴을 포함하여 악성 소프트웨어에 노출될 경우 그 코드는 해독됨

  - 주기적으로 제어 모듈은 악성 소프트웨어 시그니쳐에 대한 목표 코드를 스캔하기 위하여 해독을 정지함

  - 해독하는 동안 목표 코드는 완전히 통제된 환경에서 해독되고 있기 때문에 실제로 개인 컴퓨터 환경에 손상을 일으킬 수 없음

  - 일반적 복호 스캐너와 관련된 가장 어려운 설계 문제는 각 해독을 얼마나 오랫동안 실행시킬지 결정하는 것

- 호스트 기반 스캐너 - 행동 차단 소프트웨어

  - 악의적인 행동에 대하여 실시간으로 호스트 컴퓨터의 운영체제를 통합하고 프로그램 동작을 감시함
  - 시스템의 영향을 미칠 수 있는 기회를 가지기 전에 행동 차단 소프트웨어는 잠재적으로 악성 행동을 차단함
  - 감지 행동
    - 파일 열기, 보기, 지우기, 수정 등의 시도
    - 디스크 드라이브 및 다른 복구할 수 없는 디스크 작동의 초기화 시도
    - 실행 파일 또는 매크로의 로직 수정
    - 시작 설정과 같은 중요한 시스템 설정의 수정
    - 실행 내용을 보내기 위한 전자메일과 긴급한 메시징 클라이언트의 스크립팅
    - 네트워크 통신 야기
  - 행동 브로커는 의심되는 소프트웨어를 실시간으로 차단할 수 있기 때문에 확립된 안티바이러스 검출 기술에 비해 장점을 가짐

- 호스트 기반 스캐너 - 스파이웨어 감지 및 제거

  - 일반적인 안티바이러스 제품이 스파이웨어를 감지하는 것을 포함하여도 악성 소프트웨어 같은 위협은 스파이웨어에 특화된 감지 및 제거 유틸리티가 존재함
  - 이것은 스파이웨어의 감지와 제거에 특화되어 있고 더욱 견고한 능력을 제공

- 호스트 기반 스캐너 - 루트킷 대비책

  - 네트워크와 호스트 기반 IDS는 들어오는 트래픽에서 알려진 루트킷 공격의 코드 시그니쳐를 찾을 수 있음

  - 호스트 기반 안티바이러스 소프트웨어는 알려진 시그니쳐를 인식하기 위하여 사용될 수 있음

  - 새로운 시그니쳐를 갖는 또는 변형된 버전의 루트킷이 있을 경우,

    - 시스템 호출의 가로채기나 키보드 드라이버와 연동하는 키로거와 같은 루트킷의 존재를 밝혀낼 수 있는 동작이 시스템이 필요함

  - 커널 레벨 루트킷이 감지된다면
    - 복구하기 위한 안전하고 신뢰성 있는 방법은 감염된 기계에 새로운 OS를 설치하는 것

- 주변 장치 스캔 접근 방법

  - 감시 소프트웨어의 사용

    1. 입구 모니터

    - 기업 네트워크와 인터넷 경계에 위치
    - 경계 라우터의 진입 여과 소프트웨어의 일부이거나 외부 방화벽 또는 분리된 수동 모니터의 소프트웨어일 수 있음
    - 모니터는 변칙 또는 시그니쳐를 사용할 수 있음
    - 악성 소프트웨어 트래픽을 검출하기 위해 경험적 방법을 사용
      예) 입력 트래픽이 사용되지 않는 지역 IP 주소를 사용하는지 검사하는 것

    2. 출구 모니터

    - 기업 네트워크와 인터넷 사이의 경계뿐만 아니라 기업 네트워크에서의 개인 LAN의 출구에 위치할 수 있음
    - LAN의 출구에 위치할 경우: LAN 라우터 또는 스위치의 출구 여과 소프트웨어의 부분이 됨
    - 나가는 트래픽을 감시하는 것에 의하여 악성 소프트웨어 공격 원을 잡아낼 수 있도록 설계됨
    - 웜에서 사용된 비정상적인 전자메일 웜이나 스팸 페이로드에서 사용되는 것처럼 비정상으로 높은 전자메일 트래픽을 감지하고 대응할 수 있음

- 분산 정보의 수집 접근 방법
  - 안티바이러스 소프트웨어가 사용되는 마지막 위치는 분산 구성에 있음
  - 많은 호스트 기반과 주변 센서로부터 데이터를 수집하고, 데이터의 연관성을 분석할 수 있도록 수집된 데이터를 중앙 분석 시스템에 전달함
  - 관련된 시스템 모두에게 악성 소프트웨어에 대응하고 방어할 수 있는 갱신된 시그내쳐와 행동 패턴을 되돌려줌
  - 이러한 더 많은 시스템이 제안되었고, 구체적인 예는 분산 침입 방지 시스템(IPS)임

## 5-10. 최근 동향 / 사례

### 10. 최근 동향 / 사례

- 모바일 악성코드 주요 키워드

  - 무선랜 파밍, 스파이앱, 포인트결제 악성앱, 보이스피싱, 앱카드 인증우회, PC 통한 스마트 폰감염, 좀비폰, 몸캠피싱, 스미싱, 다크웹 악성앱, 도청업 판매, 뱅킹 악성앱, 자동차 해킹앱

- 모바일 악성 앱의 일반적인 실행 흐름

가. 시스템 권한 허용 요청
나. 배터리 최적화 권한 요청
다. 아이콘 숨김
라. 플레이 프로텍트 비활성화
마. 분석환경 실행 방지
바. 인터넷 접속 테스트
사. 설치된 앱 목록 확인
아. 백그라운드 실행

- 악성 앱 설치 유도 및 실행 과정(스미싱 예)

악성 앱 APK 다운로드 유도 -> 악성 앱 설치 및 실행 (서비스 시작) -> 시스템 권한 요청 (연락처, 네트워크 등) -> 사용자의 시스템 권한 허용 -> 악성 앱 실행 및 악성 행위

=> 악성 앱 삭제 이후에도 반복 설치

### 최근 악성코드 유형별 비율

- Trojan-Downlaoder: 사용자의 컴퓨터에 침투한 후 인터넷을 통해 추가적인 악성 소프트웨어를 다운로드하는 트로이 목마

- Trojan-Dropper: 사용자의 컴퓨터에 몰래 침투하여 다른 악성 파일을 내부에 숨긴 채로 설치하고 실행하는 트로이 목마
