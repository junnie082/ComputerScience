# Computer Security

# 4장. 데이터베이스와 클라우드 보안

#### 2024.10.18.(금)

### 목차

1. 데이터베이스 보안의 필요성
2. 데이터베이스 관리 시스템(DBMS)
3. SQL 주입 공격
4. 데이터베이스 접근 제어
5. 추론
6. 데이터베이스 암호화
7. 클라우드 컴퓨팅
8. 클라우드 보안 위험과 대응
9. 클라우드 데이터 보호
10. 서비스로서 클라우드 보안
11. 클라우드 보안의 핵심이슈 및 대응책
12. 클라우드 네이티브 및 보안

## 4-1. 데이터베이스 보안의 필요성

### 1. 데이터베이스 보안의 필요성

- 데이터베이스의 중요한 정보들은 일반적으로 하나의 로컬 시스템에 통합되어 저장

예) 회사 재정 데이터, 기밀 전화 기록, 고객과 직원의 정보, 독점 상품 정보, 의료 정보

- 데이터베이스 정보들은 내,외부 공격자의 오용과 변경의 위협의 대상

- 데이터베이스 보안은 통합된 데이터 관리 전략에 필수적 요소

- 데이터베이스 보안이 데이터베이스 의존의 증가를 따라집지 못하는 이유 [BENN06]

  - 현재의 DBMS의 복잡도와 보안 기술 사이에 심한 불균형

- 보안 기술들이 발전되고 있지만 DBMS의 복잡도 증가는 새로운 취약점과 잠재적 오용 내포

1. 데이터베이스는 웹 서비스에서 사용되는 HTTP 보다 복잡한 SQL이라는 상호작용 프로토콜을 가짐

- 효과적인 데이터베이스 보안은 SQL의 보안 취약성에 대한 이해가 필요

2. 일반적으로 조직에서는 데이터베이스 보안 전담 인력이 부족

- 대부분의 조직은 데이터베이스 관리자와 보안관리자가 구분
- 데이터베이스 관리자 - 보안에 대한 제한적 지식 보유하여 보안 기술 적용의 시간 부족
- 보안 관리자 - DBMS와 데이터베이스에 대한 제한적 지식 보유

3. 기술이 발달함에 따라 다양한 데이터베이스 플랫폼과 응용프로글매 개발은 보안 실무자 및 인력 양성에 대해 부담 가중

## 4-2. 데이터베이스 관리 시스템

### 2. 데이터베이스 관리 시스템

- 데이터베이스

  - 여러 응용프로그램이 사용하는 구조화되어 저장된 데이터의 집합
  - 데이터
  - 데이터 그룹 간의 관계도 포함

- 데이터 파일과 데이터베이스의 차이

  - 간단한 인사 파일은 개인들의 레코드 집합으로 구성
    - 레코드 - 이름, 주소, 생일, 직위, 급여와 같은 정보
  - 인사 데이터베이스
    - 인사 파일을 포함하고 각 직원들의 근무 시간 같은 근무 일지 파일도 포함
    - 데이터베이스에서는 이러한 파일들이 연결되어 급여 지급 프로그램이 근무시간과 직원의 급여 수준 정보를 추출하여 급여를 산출

- 데이터베이스 관리 시스템 (DBMS: DataBase Management System)

* 데이터베이스를 구축 및 유지하면서 다수의 사용자와 응용프로그램들에게 쿼리를 제공하는 프로그램군
* 데이터베이스 테이블을 사용해 물리적 데이터베이스를 관리

- 데이터베이스 인터페이스

  - 파일 관리 모듈과 트랜잭션 관리 모듈을 통하여 제공

- 권한 테이블

  - 사용자들이 쿼리 언어 명령문을 데이터베이스에 실행하는 권한을 보증

- 동시 접근 테이블

  - 동시에 충돌되는 명령이 실행되었을 때 충돌을 방지

- 데이터 정의어(DDL: Data Definition Language)

  - 데이터베이스의 논리적 구조와 절차적 속성을 정의
  - CREATE, ALTER, DROP, CASECADE, RESTRICTED

- 데이터 조작어(DML: Data Manipulation Language)

  - 응용프로그램 개발자에게 강력한 도구를 제공
  - INSERT, DELETE, UPDATE, SELECT

- 쿼리 언어(Query)

* 사용자를 지원하기 위한 선언적 언어

- 데이터베이스 시스템은 많은 양으 데이터에 대한 효율적인 접근을 제공

- 복잡도와 중요성 때문에 데이터베이스 시스템은 보편적인 OS 기반 보안 메커니즘이나 독립형 보안 패키지의 능력 이상의 보안을 요구

- DBMS는 상세한 접근 제어를 제공
  - 데이터베이스 내의 특정 항목에 대한 선택, 삽입, 수정, 삭제 같은 넓은 범위의 명령어

## 4-3. SQL 주입 공격

### 3. SQL 주입 공격

- SQLi: SQL Injection Attacks

- 가장 널리 사용되며 위협적인 네트워크 기반 보안 공격

- 웹 응용프로그램 페이지의 특성을 활용하도록 설계

- 위해한 SQL 명령을 데이터베이스 서버에 전송

- 가장 흔한 공격 목적: 대량의 데이터 추출

- SQL 주입의 활용

  - 데이터의 삭제, 변경
  - 임의의 OS 명령 수행
  - DoS 공격 실행

- SQL 주입 공격 과정

1. 공격자는 웹 응용프로그램의 취약성을 찾고 웹 서버에 명령을 보내 SQL 명령을 데이터베이스에 주입

- 명령은 방화벽이 허용하는 트래픽에 주입

2. 웹 서버는 위해 코드를 수신하고 웹 응용프로그램 서버로 전송

3. 웹 응용프로그램 서버는 위해 코드를 웹 서버로부터 수신하고 데이터베이스 서버로 전송

4. 데이터베이스 서버는 위해 코드를 데이터베이스에 실행

- 데이터베이스는 신용카드 테이블에서 데이터를 반환

5. 웹 응용프로그램 서버는 데이터베이스의 신용카드 정보를 포함하는 데이터로 동적으로 페이지를 생성

6. 웹 서버는 신용카드 정보를 해커에 전송

- 주입 기법
  - SQLi 공격은 통상적으로 조기 종료된 문자열에 새 명령어를 추가
  - 삽입된 명령은 실행 전에 부가적으로 추가된 문자열을 가질 수 있기 때문에, 공격자는 주입된 문자열을 주석 표기 "- -"로 끝마침
  - 후속 텍스트는 실행 시 무시됨

### SQLi 공격 방법

- 사용자 입력

  - 공격자는 적절하게 조합된 사용자 입력을 통해 SQL 명령어 주입

- 서버 변수

  - HTTP 헤더, 네트워크 프로토콜 헤더, 환경변수 등 포함
  - 공격자는 HTTP, 네트워크 헤더의 값들을 위조할 수 있으므로, 값들을 직접 헤더 안에 주입
  - 데이터베이스의 서버 변수를 주입하는 쿼리가 발생하면, 위조된 헤더 내의 공격이 동작

- 2차 주입

  - 악의적인 사용자가 시스템/데이터베이스에 존재하는 데이터를 이용하여 SQL 주입 공격
  - 시스템이 공격을 발생하도록 쿼리를 변경한 입력 실행

- 쿠키 변경

  - 공격자는 쿠키를 변경하여 응용프로그램 서버가 변경된 내용, 구조, 기능을 갖는 쿠키를 사용하여 SQL 쿼리를 생성

- 물리적 사용자 입력
  - 웹 요청 범위 밖의 공격을 만드는 사용자 입력을 제공
  - 바코드, RFID 태그, 광학적 인식 종이 등

### SQLi 공격 유형

#### 대역 내 공격 (In-band Attacks)

- SQL 코드 주입과 결과 변환 -> 같은 통신 채널 사용
- 반환된 데이터는 응용프로그램 웹 페이지에 직접 표현
- 공격 유형
  - 동의어 중복: 하나 혹은 여러 조건문에 코드를 주입하여 항상 참이 되도록 함
  - 라인 종단 주석: 특정 필드에 코드를 주입한 후, 뒤의 정상적인 코드는 라인 종단 주석의 사용으로 무효화 처리됨 (예, --)
  - 피기백 (Piggybacked) 쿼리: 공격자는 쿼리를 추가하여, 정상 요청 위에 악의적인 쿼리를 편승시킴 (예, 공격자가 정상적인 쿼리 끝에 ; DROP TABLE users 와 같은 SQL 명령을 추가 // 테이블 삭제)

#### 대역 외 공격 (Out-of-Band Attack)

- 공격자가 작업한 채널을 사용하여 공격을 시작하고 결과를 수집할 수 없는 경우 -> 다른 통신 채널을 사용

- 정보 검색에 제한이 있지만 데이터베이스 서버의 응답이 매우 불안정할 때 사용

- 예) HTTP 요청 기반 Out-of-Band 공격
  - 데이터베이스가 특정 이벤트 발생 시 공격자가 운영하는 서버로 HTTP 요청을 보내기도 함
  - 공격자는 이 요청을 통해 민감한 정보를 수집

#### 추론적 공격 (Inferential Attack)

- 실제 데이터 전송은 없고, 공격자가 특정 요청을 보내고 웹사이트/데이터베이스 서버의 결과 행위를 관찰함으로써 정보를 재구성

1. 불법/논리적으로 틀린 쿼리

- 공격자가 후위의 웹 응용프로그램 데이터베이스의 유형과 구조에 대한 정보를 수집할 수 있게 함
- 공격은 정보-수집의 예비 단계로 간주됨

2. 블라인드 SQL 주입

- 공격자에게 시스템 오류 정보를 보여주지 않을 만큼 안전하더라도 데이터베이스 시스템에 존재하는 데이터를 추론할 수 있게 함
- 예)
  .로그인 폼에 SQL Injection이 가능하다고 가정 시, 서버가 응답하는 로그인 성공과 실패 메세지를 이용 -> DB의 테이블 정보 추출
  . Time Based SQL Injection
  서버로부터 특정한 응답 대신에 참 혹은 거짓의 응답을 통해서 데이터베이스의 정보를 유추

### SQLi 대응: 방어적 코딩, 탐지, 실시간 방지

1. 방어적 코딩

- 수동 방어적 코딩 습관

  - SQLi 공격이 활용하는 흔한 취약점은 불충분한 입력 실증
  - 이러한 취약성을 없애기 위한 쉬운 솔루션
  - DBMS의 오류를 야기하는 공격을 회피할 수 있음

- 매개변수 쿼리 삽입

  - 응용프로그램 개발자가 보다 정확한 SQL 쿼리 구조를 명기
  - 독립적으로 매개변수 값을 전달하여 의심되는 사용자 입력이 쿼리 구조를 변경하지 못하게 함

- SQL DOM (Domain Object Model)
  - SQL 쿼리를 동적으로 생성하는 데 사용하는 기법
  - 자동화된 데이터 타입 실증과 회피를 가능하게 하는 클래스 집합
  - 데이터베이스 쿼리를 캡슐화하여 안전하고 신뢰성 있게 데이터베이스를 접근
  - 규제받지 않는 문자열 연결 쿼리 생성 과정을 타입 확인 API를 사용하는 체계적인 것으로 바꿈
  - 안전한 메서드를 사용하여 쿼리를 구성하므로 보안이 강화됨

2. 탐지

- 시그니쳐 기반 (Signature based)

  - 특정 공격 패턴을 찾음
  - 항상 업데이트 되어야 하며 자체 수정 공격 대응이 약함

- 비정상 기반 (Anomaly based)

  - 정상 행위를 정의하고 정상 범위 밖으 행위 패턴을 감지
  - 시스템이 정상 행위 범위를 학습하는 훈련 단계와 이후의 실재 탐지 단계가 있음

- 코드 분석 (Code analysis)

* SQLi 취약성을 탐지하는 시험을 포함

3. 실시간 방지

- 실시간으로 쿼리를 확인
- 자동화된 솔루션이 다양하게 존재

### 대표적인 DB 보안 솔루션

- IBM Guardium

  - 실시간 모니터링, 데이터 마스킹, 접근 제어
  - 데이터 암호화, 보안 이벤트 관리

- Oracle Data Safe

  - 데이터베이스 감사, 취약점 평가
  - 데이터 마스킹, 비밀번호 정책 관리

- McAffee Total Protection for Data

  - 데이터베이스 보안 정책 관리
  - 실시간 데이터 보호, 암호화 및 데이터 마스킹

- Imperva SecureSphere

  - 데이터베이스 방화벽, 접근 제어, 활동 모니터링, 위협 감지

- Symantec Data Loss Prevention (DLP)
  - 데이터 유출 방지, 데이터 모니터링 및 암호화

## 4-4. 데이터베이스 접근 제어

### 4. 데이터베이스 접근 제어

- 사용자가 데이터베이스 접근 권한을 갖는지 결정하는 전체적인 접근 제어 시스템을 사용

- 데이터베이스 사용 권한을 인증받은 사용자에게 데이터베이스의 일부에 접근하는 특정 능력 부여

- 다른 접근 권한, 생성, 삽입, 업데이터, 읽기, 쓰기를 구별

- 데이터베이스 접근 제어 관리 정책
  - 중앙관리(Centralized administration)
    소수의 특권 사용자들이 접근 권한을 부여 (Grant) 및 파기 (Revoke)
  - 소유권 기반의 관리(Ownership-based administration)
    테이블 소유자(생성자)가 테이블 접근 권한을 부여, 파기
  - 분산적 관리(Decentralized administration)
    테이블 접근 권한의 부여, 파기 + 테이블 소유자가 다른 사용자에게 테이블 접근 권한을 부여, 파기하는 권한을 부여, 파기

### SQL 기반 접근 정의

- 두 가지 접근 권한 관리 명령어

1. Grant (부여)

- 하나 혹은 여러 접근 권한을 허가하거나 사용자 역할을 부여
  예) GRANT SELECT ON ANY TABLE TO ricflair

2. Revoke (파기)

- 접근 권한을 파기
  예) REVOKE SELECT ON ANY TABLE FROM ricflair

- 접근 권한 목록

1. Select

- 허가자는 전체 데이터베이스, 개개의 테이블 혹은 테이블의 특정 열을 읽기 가능

2. Insert

- 허가자는 테이블에 행 삽입
- 테이블 특정 값을 갖는 열들에 행 삽입

3. Update

- 의미론적으로 INSERT와 유사

4. Delete

- 허가자는 테이블의 행 삭제 가능

5. References

- 허가자는 다른 테이블의 특정 열을 외래키로 정의 가능

* 계단식 권한 부여
  - 권한부여: 한 사용자에서 다른 사용자에게로 계단식으로 주어짐
  - 권한파기: 권한의 파기도 계단식으로 이뤄짐
    - 같은 접근권한을 여러 번 수신할 경우 문제 발생 (David)

### 역할 기반 접근 제어(RBAC)

- 역할 기반 접근 제어(RBAC)는 데이터베이스 접근 제어에 적합

- 데이터베이스 사용자의 3가지 분류 (임의의 접근 제어 환경)

1. 응용프로그램 소유자

- 응용프로그램의 일부분으로서 데이터베이스 객체(테이블, 행, 열)를 소유한 사용자
- 데이터베이스 객체는 응용프로그램에 의해 생성되거나 사용

2. 응용프로그램 소유자를 제외한 사용자

- 데이터베이스 객체를 소유하지 않지만 특정 응용프로그램을 통해 데이터베이스 객체를 동작하는 사용자

3. 관리자

- 데이터베이스 일부분 혹은 전체에 대한 관리적 책임이 있는 사용자

* 데이터베이스 RBAC은 다음 기능이 제공되어야 함

1. 역할의 생성과 삭제
2. 역할의 허가 정의
3. 사용자 역할의 할당 및 취소

- 데이터베이스 보안 역할의 좋은 예 - MS SQL

  - SQL 서버는 서버 역할, 데이터베이스 역할, 사용자 정의 역할 지원 (특정 접근권한으로 시스템에 미리 설정된 고정 역할)

- 고정된 서버 역할

  - 서버 레벨에서 정의되고 사용자 데이터베이스와 독립적으로 존재
  - 역할은 다른 허가들을 가지며 행정적 책임의 완전한 제어를 포기하지 않으면서 분산시킴
  - 데이터베이스 관리자는 고정된 서버 역할을 여러 사람에게 다른 행정적 업무를 맡기는데 사용할 수 있음

- 고정된 데이터베이스 역할

  - 개별 데이터베이스 레벨에서 동작
  - 고정된 서버역할과 같이 db_accessadmin과 db_securityadmin 같은 역할은 DBA의 행정적 책임을 보조하기 위해 설계
  - db_datareader와 db_datawriter는 사용자에게 포괄적 권한을 제공하기 위해 설계

- 사용자 정의 역할
  - 데이터베이스의 일부에 접근 권한을 지정
  - 적합한 권한을 가진 사용자 또는 관리자는 새로운 역할과 연계된 접근 권한을 정의
  - 사용자 정의 역할
    1. 표준 역할
       인가된 사용자가 다른 사용자에게 역할을 지정
    2. 응용프로그램 역할
    - 사용자 그룹보다는 응용프로그램과 연관되어 있으며 패스워드를 요구
    - 응용프로그램이 적절한 코드를 실행할 때 활성화
    - 응용프로그램에 접근하는 사용자는 데이터베이스 접근에 응용프로그램 역할을 사용

## 4-5. 추론 (Inference)

### 5. 추론 (Inference)

- (DB 보안 추론) 인가된 쿼리 수행과 합법적 응답을 통해 허가되지 않은 중요 정보를 추론

- 추론 문제의 발생 조건

  - 많은 데이터 아이템의 조합이 개별 아이템보다 민감
  - 데이터 아이템들의 조합이 보다 민감한 데이터를 추론할 때

- 공격자는 메타데이터 or 민감하지 않은 데이터를 사용

  - 메타데이터(Metadata): 특정 사용자가 정보를 추론하는데 사용할 수 있는 데이터 아이템들간의 상관관계 혹은 의존성에 대한 지식

- 비인가된 데이터의 정보 전송 경로는 `추론 채널(inference channel)`를 통해서 전송

- 추론에 의한 노출 위협에 대한 접근 방법

1. 데이터베이스 설계 시 추론 탐지

- 데이터베이스 구조 변경 혹은 접근 제어 방식의 변경으로 추론 채널을 제거함으로써 추론을 방지
- 테이블을 여러 테이블로 분할하여 데이터 의존성을 제거하거나 RBAC 방식에서보다 세밀한 접근 제어 역할을 포함
- 불필요하게 엄격한 접근제어 때문에 가용성이 제한됨

2. 쿼리 타임 시 추론 탐지

- 쿼리 처리 중 추론 채널 위반을 제거하려는 시도
- 추론 채널이 탐지되면 쿼리를 거부하거나 변경

### 추론의 예

- 뷰 사용자들은 항목과 가격의 관계에 접근이 허가되지 않음

  - 항목을 알더라도 가격을 추론할 만한 충분한 정보 같은 기능적 관계가 없음을 의미

- 제고 테이블의 구조를 알고 제고 테이블과 같은 행 순서를 갖는 뷰 테이블들을 아는 사용자

-> 두 뷰의 병합 가능

- 항목과 비용의 속성들이 노출되지 말아야 하는 접근 제어 정책을 위반

## 4-6. 데이터베이스 암호화

### 6. 데이터베이스 암호화

- 데이터베이스는 조직의 가장 가치 있는 정보자원

  - 여러 보안 계층으로 보호
    - 방화벽, 인증 메커니즘, 접근 제어 시스템, 데이터베이스 접근 제어 시스템, 데이터베이스 암호화
    - 암호화는 데이터베이스 보안의 최후의 방어선
  - 전체 데이터베이스에 대해 레코드 레벨(선택된 레코드 암호화), 속성 레벨(선택된 속성 암호화), 혹은 개별 필드 레벨에 대해 적용 될 수 있음

- 데이터베이스 암호화의 단점

1. 키 관리

- 인가된 사용자는 접근하는 데이터의 복호화 키에 접근해야만 함
- 일반적으로 폭넓은 사용자와 응용프로그램이 접근 가능
- 인가된 사용자와 응용프로그램에게 선택된 부분의 데이터베이스의 보안키를 제공하는 것은 복잡함

2. 비유연성

- 데이터베이스의 부분이나 전체가 암호화되면 레코드 검색이 더 어려워짐

### 데이터베이스 암호화 기법

- 데이터 소유자(Data owner)

  - 조직 내 또는 외부 사용자에게 가능한 데이터를 생성하는 기관

- 사용자(User)

* 요청(쿼리)을 시스템에게 보내는 사람
* 사용자는 서버를 통해 데이터베이스에 접근 허가를 받은 조직의 고용인
* 인증을 통해 접근 허가를 받은 조직 외부의 사용자

- 고객(Client)

* 사용자 쿼리를 서버에 저장된 암호화된 데이터에 대한 쿼리로 전환하는 객체

- 서버(Server)

* 데이터 소유자로부터 암호화된 데이터를 받고 고객에게 배포하는 기관
* 서버는 데이터 소유자가 소유할 수도 있지만, 통상적으로는 외부 제공자에 의해 소유되고 관리됨

[가정]

1. DB의 개별 항목은 독립적으로 암호화되고, 같은 암호화키를 사용
2. 암호화된 DB는 서버에 저장, 서버는 키를 모르고, 서버의 데이터는 안전함
3. 고객시스템에서 암호화키의 복제본을 소유함
4. 고객측의 사용자는 다음 과정을 통해 DB의 레코드를 검색 가능

## 4-7. 클라우드 컴퓨팅

### 7. 클라우드 컴퓨팅

- 클라우드 컴퓨팅 정의 [NIST SP-800-145]
  - 네트워크, 서버, 저장 장치, 응용프로그램, 서비스 같은 공유된 컴퓨팅 자원의 모음에 대한 항시적이고 편리하며 필요할 때마다 접근 가능한 모델
  - 서비스의 제공과 종료가 최소한의 관리적인 노력이나 서비스 제공업체와의 상호작용이 요구
  - 클라우드 모델은 서비스 제공 시간을 늘려주며, 다섯 가지 핵심 특성, 세 가지 서비스 모델, 네 가지 설치 모델이 존재

### 클라우드 컴퓨팅의 세가지 서비스 모델

1. Software as a Service (SaaS)

- 사용자는 클라우드에서 실행되고 있는 특정 응용프로그램 소프트웨어를 제공 받음
- 고객이 클라우드 제공자의 기반 시설에서 실행되는 응용프로그램을 사용할 수 있게 함
- 소프트웨어의 설치, 관리, 업그레이드 및 수정 등의 복잡한 작업을 피하게 해줌
  예) Gmail, Salesforce.com 등

2. Platform as a Service (PaaS)

- 사용자는 사용자 응용프로그램이 실행될 수 있는 플랫폼을 제공받음
- 클라우드 기반 시설에 사용자가 생성하거나 구입한 응용프로그램을 배치하도록 함
- 유용한 소프트웨어 빌딩 블록과 프로그래밍 언어, 실행 환경, 응용프로그램 설치 도구 같은 여러 개발 도구를 제공
- 예) Google App Engine, Salesforce1 플랫폼

3. Infrastructure as a Service(IaaS)

- 사용자에게 클라우드 기반 시설에 대한 접근을 제공
- API를 통해 제어되는 가상 기계, 추상화된 하드웨어와 운영체제를 제공
- 사용자가 임의의 운영체제와 응용프로그램을 배치하고 실행할 수 있는 처리기, 저장 공간, 네트워크, 그 외 기본적인 컴퓨팅 자원을 제공
- 사용자가 데이터 저장소 같은 기초 컴퓨팅 서비스로 고도의 컴퓨터 시스템을 조합할 수 있게 함
  예) Amazon EC2, Windows Azure 등

### 클라우드 컴퓨팅의 배치 모델

1. 공용 클라우드 (Public cloud)

- 클라우드 시스템이 일반 사용자나 대규모 산업 집단에 제공되고 서비스를 제공하는 한 업체에 의해 소유됨

- 클라우드 기반 시설과 제어기능 모두 서비스 제공업체의 책임

2. 사적 클라우드 (Private cloud)

- 클라우드 시스템이 전적으로 하나의 조직에만 제공됨
- 그 조직이 스스로 관리를 하거나 혹은 제3자가 관리할 수 있고, 기반 시설이 조직 사이트 내에 존재하거나 외부에 존재할 수 있음
- 제공 업체는 기반 시설만 책임이 있고 제어는 책임이 없음

3. 커뮤니티 클라우드 (Community cloud)

- 클라우드 시스템이 여러 조직에 의해 공유되고, 미션, 보안 요구 사항, 정책, 적합성 고려사항에 대한 같은 고려사항을 공유하는 특정 집단을 지원하는 경우

- 조직들과 제3자에 의해 관리될 수 있고 그 위치도 조직 내외부 모두 가능

4. 혼합 클라우드 (Hybrid cloud)

- 다수의 공용, 사적, 혹은 커뮤니티 클라우드 시스템들로 이루어진 클라우드 시스템

- 각 클라우드는 고유의 시스템으로 남아있으나 데이터와 응용프로그램의 이동성을 지원하는 표준/비표준 기술을 이용해서 서로 긴밀히 연결

### 클라우드 컴퓨팅 참조 구조

- [NIST SP 500-292]

  - "어떻게" 솔루션을 설계하고 구현하는가 대신 클라우드 서비스가 제공하는 "무엇"의 요구 사항에 중점을 둠
  - 참조 구조는 클라우드 컴퓨팅의 동작 복잡성의 이해를 보조

- NIST 클라우드 컴퓨팅 참조 구조의 목표
  - 다양한 클라우드 서비스를 전체 클라우드 컴퓨팅 개념적 모델에서 이해하 쉽도록 보조
  - 고객이 클라우드 서비스를 이해, 논의, 분류, 비교하는 데 기술적 참조를 제공
  - 보안, 상호 운용성, 이식성에 대한 표준과 구현에 대한 분석을 제공

### NIST 참조 구조의 행위자

1. 클라우드 소비자(Cloud Consumer)

- 클라우드 제공자와 비즈니스 관계를 유지하거나 클라우드 서비스를 사용하는 개인이나 조직

2. 클라우드 제공자(Cloud Provider)

- 이해관계자들을 위해 서비스를 생성하는 책임을 가지는 개인이나 조직

3. 클라우드 감사자(Cloud Auditor)

- 클라우드 서비스, 정보 시스템 운용, 성능, 클라우드 구현의 보안에 대한 독립적인 평가를 하는 관계자

4. 클라우드 중개인(Cloud Broker)

- 클라우드 서비스의 사용, 성능, 전달, 클라우드 제공자와 소비자 간의 협상을 관리하는 존재

5. 클라우드 전달자(Cloud Carrier)

- 클라우드 제공자와 소비자 사이에서 서비스의 연결과 전달을 제공하는 중간자

### 8. 클라우드 보안 위험과 대응

- 클라우드 컴퓨팅의 남용과 오용

  - 많은 클라우드 서비스 제공자들의 경우 사용자가 서비스를 등록하고 사용을 시작하기가 비교적 용이하며 어떤 제공자들은 무료 체험 기간 제공함
  - 공격자들은 쉽게 클라우드 시스템 내부에 들어와서 스팸 메일을 보내거나 악성코드 공격을 하거나 DoS 공격 등을 시도해볼 수 있음
  - 대응 방법
    1. 보다 엄격한 초기 등록과 유효성 프로세스
    2. 향상된 신용카드 부정 사용 감시
    3. 고객 네트워크 트래픽에 대한 포괄적인 조사
    4. 네트워크 블록의 공개 블랙리스트 감시

- 비보안 인터페이스와 APIs

  - 제공자는 사용자가 클라우드 서비스를 관리하고 이용하기 위해서 사용하는 소프트웨어 인터페이스 - API를 공개
  - 대응 방법
    1. 제공자 인터페이스의 보안 모델 분석
    2. 강한 인증과 접근 제어, 암호화 전송 구현
    3. API 관련 의존 관계 이해

- 악의적 내부자

  - 내부자의 공격은 통상적인 보안 기법들로 대응하기 어려움
  - 대응 방법
    1. 엄격한 공급망 관리 강화와 포괄적인 공급자 평가 수행
    2. 법적 계약의 일부분으로 인적 자원 요구 명시
    3. 전체 정보 보안과 관리에 투명성과 보고 요구
    4. 보안 침해 알림 프로세스 결정

- 공유 기술 이슈

  - IaaS 업체들은 기반 시설을 공유함으로써 보다 스케일이 큰 서비스를 제공할 수 있으나 공격자가 쉽게 접근 가능하며 보안 관리의 약점
  - 대응 방법
    1. 설치/구성에 대한 최선 보안 습관 구현
    2. 비인가된 수정/행위에 대한 환경 감시
    3. 강한 인증과 관리를 위한 접근과 동작에 대한 접근 제어 증진
    4. SLAs의 취약성 보완에 대한 패치 강화

- 데이터 손실과 누출

  - 가장 치명적인 보안 위험
  - 대응 방법
    1. 강한 API 접근 제어 구현
    2. 전송되는 데이터의 암호화와 무결성 보호
    3. 데이터 보호를 설계와 실행 시 분석
    4. 강한 키 생성, 저장, 관리, 폐기 구현

- 계좌 혹은 서비스 탈취

  - 비밀번호 유출과 함께 가장 위협적인 공격
  - 비밀번호 유출로 인해 공격자는 클라우드 컴퓨팅 서비스의 중요한 부분에 접근
    -> 서비스의 비밀성, 무결성, 그리고 접근성을 깨뜨릴 수 있음
  - 대응 방법
    1. 사용자와 서비스 간의 계좌 보증서 공유 금지
    2. 가능한 강한 2 factor 인증 기법 장착
    3. 비인가된 행위 탐지 이후 사후 감시 사용
    4. 클라우드 제공자 보안 정책과 SLAs 이해

- 알려지지 않은 위험 프로파일
  - 클라우드 기반 시설을 사용함에 있어 클라이언트는 보안에 영향이 있을 만한 수많은 이슈에 대해서 클라우드 제공 업체에 일임하여야 함
  - 클라이언트는 위험 요소를 관리하기 위해서 필요한 역할과 책임을 명료하게 정의하고 주의해야만 함
  - 대응 방법
    1. 가능한 로그와 데이터 공개
    2. 기반 시설(예, 패치 레벨, 방화벽)의 부분/ 전체 공개
    3. 필요한 정보 감시와 경계

### 9. 클라우드 데이터 보호

- 클라우드 데이터에 대한 보안 필요성

  - 많은 위험 요소와 그 요소들 간의 상호작용
  - 클라우드 환경의 구조 및 운영적인 특성

- Multi-instance 모델

  - 각 클라우드 사용자에게 할당된 가상머신에서 독립적으로 실행되는 DBMS를 제공
  - 보안에 관한 역할 정의, 사용자 인증 및 다른 관리 작업에 대해서 완전한 제어 권한을 사용자에게 부여

- Multi-tenant 모델
  - 사용자들에게 똑같은 환경을 공유하고 구분을 위해서 데이터를 사용자 ID로 tagging하는 방식
  - Tagging은 데이터베이스를 독점적으로 사용하는 듯한 느낌을 주지만 안전한 데이터베이스 사용 환경을 만들고 유지하는 것은 전적으로 클라우드 제공 업체에 의존하게 됨

## 4-10. 서비스로서 클라우드 보안

- 클라우드 보안에서 SaaS (Software as a Service) 서비스의 일부분으로 SecaaS가 있음

- SecaaS - 클라우드 혹은 클라우드 기반 기반 시설을 통해 보안 응용 프로그램과 서비스를 고객의 시스템에 제공 [Cloud Security Alliance]

### 클라우드 보안 가이드라인 [NIST SP-800-14]

| 거버넌스(Governance) | 조직의 습관과 관련된 것을 서비스의 설계, 구현, 테스트, 사용, 감시뿐만 아니라 클라우드의 응용프로그램 개발과 서비스 지원의 정책, 절차, 표준으로 확장 |
| 컴플라이언스(Compliance) | 조직에 보안과 개인 정보 보호 책임을 부과하는 다양한 종류의 법과 규제, 데이터 위치, 개인 정보와 보안 제어, 레코드 관리, 전기적 복구 요구 사항 등을 포함하는 클라우드 컴퓨팅의 잠재적 영향 이해 |
| 트러스트(Trust) | _ 서비스 구성이 클라우드 제공자에 의해 배치된 보안과 개인 정보 제어와 처리, 성능에 충분한 가시성을 가지고 있도록 보장 _ 데이터에 대한 명확하고 배타적인 소유권을 확립 _ 시스템의 수명 주기 동안 끊임없이 진화하고 변화하는 위험 환경에서 적응할 만큼 유연한 위험 관리 프로그램을 제정 _ 정보 시스템의 보안 상태의 지속적인 감시로 계속적인 위험 관리 결정을 지원 |
| 구조(Architecture) | 클라우드 제공자가 전체 시스템 컴포넌트들과 시스템 수명 주기 동안 시스템의 보안과 개인 정보에 기술적 제어가 가진 함축적 의미를 포함한 서비스를 제공하기 위해 사용하는 기반 기술들을 이해 |
| 신원과 접근 관리(Identity and access management) | 적절한 보호 수단이 인증, 공인, 다른 식별과 접근 관리 기능을 위해 있고, 조직의 적합함을 보장 |
| 소프트웨어 분리(Software isolation) | 클라우드 제공자가 multi-tenant 소프트웨어 구조에서 사용하는 가상화와 다른 논리적 분리 기술들을 이해하고, 조직의 위험을 평가 |
| 데이터 보호(Data protection) | _ 데이터를 휴식기, 전송, 사용 중 안정 보장을 위해 조직에 대한 클라우드 제공자의 데이터 관리 솔루션의 적합성, 데이터의 접근 제어 능력을 평가 _ 조직 데이터의 위협 가능성이 높거나 데이터의 중요한 농축된 값을 나타내는 다른 조직과의 조합에 대한 위험을 고려 _ 클라우드 환경에서 가용한 장비로 암호화키 관리와 제공자에 의한 처리의 위험을 충분히 숙지 |
| 가용성 (Availability) | _ 가용성, 데이터 백업과 복구, 재난 복구에 대한 계약 조항 및 절차 이해와 이들의 조직의 연속성과 비상계획 요구사항과 부합함을 보장 _ 중/장기 장애 또는 심각한 재난 발생 동안, 중요한 작업은 즉시 재개 가능하고, 모든 작업은 적시에 조직적으로 복원되도록 보장 |
| 사고 대응 (Incident response) | _ 사고 대응에 관한 계약 조항과 절차를 이해하고 조직의 요구 사항에 부합을 보장 _ 클라우드 제공자가 투명한 대응 프로세스와 사고 중이나 후에 충분한 정보 공유를 하는 메커니즘을 갖도록 보장 _ 조직이 컴퓨팅 환경의 클라우드 제공자의 역할과 책임에 맞추어 조정된 방식으로 사고에 대응하도록 보장 |

### 서비스로서 클라우드 보안

- SecaaS 서비스 카테고리 [Cloud Security Alliance]

* 신원과 접근 관리
* 데이터 손실 방지
* 웹 보안
* 이메일 보안
* 보안 평가
* 침입 관리
* 보안 정보와 이벤트 관리
* 암호화
* 비즈니스 연속성과 재난 복구
* 네트워크 보안

### 11. 클라우드 보안의 핵심이슈 및 대응책

- 클라우드 컴퓨팅 환경 구성요소

  - 가상환경
  - 가상화 인프라, 하드웨어, 설비, 클라우드 인프라
  - 정책, 사고.장애 대응, 인증.권한, 데이터

- 클라우드 컴퓨팅 환경 보안속성

| 보안속성 | 내용 |
| 인증 | 클라우드 컴퓨팅에 접근하는 사용자를 식별하여 불법적인 사용자의 저근을 차단하는 보안 속성 |
| 기밀성 | 클라우드 컴퓨팅에서 유통되거나 저장되는 데이터를 비인가자가 탈취하더라도 데이터의 정보를 얻지 못하도록 하는 보안속성 |
| 무결성 | 클라우드 컴퓨팅에서 유통되거나 저장되는 데이터를 비인가자가 위,변조 못하도록 하는 보안속성 |
| 가용성 | 클라우드 컴퓨팅에서 클라우드 컴퓨팅 구성요소에 대한 접근성을 항시 보장하는 보안 속성 |
| 감사 | 클라우드 컴퓨팅에 접근한 사용자 기록을 항시 유지하여 해킹 등의 사고발생시 원인 규명을 위한 용도로 사용되는 보안속성 |
| 권한 | 클라우드 관리자, 가상서버 관리자, 사용자에 따른 접근 권한 및 접근 영역의 분리를 통해 클라우드 컴퓨팅의 접근통제에 사용하는 보안속성 |

- 보안 위협 예시

| 클라우드 컴퓨팅 환경 구성 요소 | 보안 위협 예시 | 보안속성 |
| 가상 환경 | - 악성코드 감염 - SaaS 애플리케이션 취약점 - 인터페이스 및 API 취약점 - 가상자원 격리 위협 - 개발, 운영 가상환경 비인가 접근 - App 데이터 변조 | 기밀성, 무결성 |
| 클라우드 인프라 | 설비 - 물리적 위협 (화재, 정전 등), 하드웨어 - QoS, DDoS, Flood Attack, 네트워크 장비 설정 오류, 가상화 인프라 - Multi-Tenancy (다중임차), 공유 위협, 솔루션 설정 오류 | 기밀성, 무결성 |
| 정책 | - 규정/법 미준수 - SLA 위반 - 인적 보안 - 용역 관리 | 감사 |
| 사고 및 장애 대응 | - 동일 사고 재발생 - 백업/복원 실패 - 사고 후 운영 실패 | 가용성 |
| 인증 및 권한 | - 계정 탈취 - 권한 상승/오용 - 내부자 위협 - 단말 보안 | 인증, 권한 |
| 데이터 | - 데이터 유츨 - 데이터 파괴 - 데이터 위치 (사법권할권) - 데이터 안정성 (백업 및 복원) | 기밀성, 무결성 |

- 클라우드 보안 위협

| 구분 | 위협요소 | 세부항목 및 내용 | CSA 분류 매핑 |
| 기술적 | 기존 보안 위협 - 네트워크 트래픽의 도청 및 위변조 - 인증 및 접근권한 탈취에 다른 데이터 유출, 손실 - 서비스 거부 (DoS, DDoS) 공격 - 시스템 설계상의 오류 | 데이터유출, 불충분한 신분(접근) 관리, 불안전한 API, 시스템 취약점, 계정탈취, DDoS 공격, APT 공격 가상화를 통한 위협 - 하이퍼바이저 감염 - VM 내부공격 및 이로 인한 침입탐지 어려움 - 가상머신의 이동성에 따른 보안 문제 | 공유기술 취약점, 데이터유츨, 시스템 취약점, APT 공격 |
| 기술외적 | 관리 측면 문제 - 내부자의 설계/관리 실수 - 사용자의 계정정보 유출 - 다양한 해커들에게 해킹의 빌미를 제공 - 피해규모의 확산 - 데이터센터 건물 관리 - 화재, 지진 등의 재해로 인한 데이터 센터의 물리적인 피해와 이로 인한 데이터 유실 | 악의적 내부자, 데이터 유실, 불충분한 실사, 불손한 사용, 공유기술 취약점 / 법제도 문제 - 지리적으로 분산된 인프라의 경우 국가별 상이한 법체계로 달라지는 정책과 자원 통제력 문제 | 불충분한 실사 |

### 클라우드 컴퓨팅을 위한 하드웨어 연결과 가상화

- 가상화 (Virtualization)

* 물리적인 컴퓨터 자원을 추상화 하는 것
* 마치 하나의 장비를 여러 개처럼 동작시키거나
* 반대로 여러 개의 장비를 묶어 사용자에게 공유자원으로 제공

### 가상화와 하이퍼바이저

- 하이퍼바이저(Hyperviser)

* 장비에 장착되어 있는 하드웨어를 가상화하기 위해 하드웨어들을 관장할 가상머신 모니터(VMM: Virtual Machine Monitor)가 필요

### 기술적 측면의 위협

- 하이퍼바이저 감염 위험

  - 가상화 시스템 내 하이퍼바이저가 취약할 경우 이를 활용하는 여러 개의 가상머신(VM)이 동시에 피해

- 가상머신 공격 경로

  - 가상 네트워크를 통한 패킷 스니핑, 패킷스니핑, 해킹, DDoS 공격, 악성코드 전파 등의 공격경로가 존재

- 공격자의 익명성

  - 공격자의 익명성에 따른 탐지 어려움
  - 기존 네트워크 보안기술(방화벽, IPS)로는 가상화 내부 영역에 대한 침입 탐지가 어려움

- 가상머신의 이동성으로 인한 문제
  - 가상머신 간 이동성으로 인한 보안 취약성
  - 악성코드가 감염된 가상머신, 보안패치가 안된 가상머신이 다른 물리적 플랫폼으로 쉽게 전파 가능

### 클라우드 보안 문제와 해결책

| 구분 | 위협요소 | 해결방안 |
| 기술적 - 기존 보안 위협 상속 | _ 네트워크 트래픽의 도청 및 위변조 _ 인증 및 접근권한 탈취에 따른 데이터 유출, 손실 _ 서비스 거부(DoS, DDoS) 공격 _ 시스템 설계상의 오류 | \* 암호화, 해싱, 디지털 서명, 중복 모니터링 등 강화 - 데이터 송수신 암호화 - 저장된 데이터의 암호화 및 키관리 - 주기적 백업 및 백신 관리 - 다단계 인증 및 접속 관리 |
| 기술적 - 가상화를 통한 위협 - 하이퍼바이저 감염 - VM 내부공격 용이성 - 공격자 익명성 - 가상머신의 이동성에 따른 보안 문제 | - 암호화를 통한 전송데이터의 보호 - 저장 데이터에 대한 암호화 및 키 관리 - 접근 권한에 대한 해쉬 검사 - 자원사용량 제한, 로그이력관리 등 VM 간의 독립성 보장 - 다양한 침입탐지 기법의 도입 - 하이버파이버 기반의 VM 감시, 대응 - 에이전트리스 기반 VM 감시, 대응 - 보안사항을 고려한 프로그램 설계 |
| 기술외적 - 관리측면 문제 | - 내부자 문제 - 해커들의 타겟 - 피해규모의 확산 - 물리적인 저장소 관리 - 자연재해 | - 내부자들에 대한 교육 및 검증된 채용 - 국제 클라우드 보안 표준을 준수하는 인증 획득 - 보안 사고발생시 보상하는 제도 및 보험을 통한 사고 대응 |
| 기술외적 - 법제도 문제 | - 국가별 상이한 법체계 | - 법적인 쟁점을 사전 점검 후 시스템 설계, 도입 - 국제 표준 |

### 12. 클라우드 네이티브 및 보안

- 클라우드 네이티브 (Cloud Native) 정의

> CNCF (Cloud Native Computing Foundation) v 1.0 클라우드 네이티브 전환할 수 있는 기술 정의 및 오픈 소스를 관리하는 단체

- 퍼블릭, 프라이빗, 하이브리드 클라우드 환경에서 확장성 있는 애플리케이션
- 컨테이너, 서비스 메시(Mesh), 마이크로서비스(Micro Service) 인프라 구조, 선언전 API로 접근
- 자동화, 회복성, 편리성, 가시성을 갖는 느슨하게 결합된 시스템 (개발 및 실행 환경)
- 엔지니어는 최소한의 수고로, 영향력이 크고, 예측 가능한 변경을 할 수 있는 기술 정의

### 클라우드와 클라우드 네이티브

- 클라우드
  : 가상화된 컴퓨팅 자원을 활용하여 소프트웨어, 플랫폼, 인프라 등의 IT 서비스를 제공하는 기술이며, 기존 IT 대비 효율적이고 신속한 서비스 제공이 가능함

- Serverless: 서버리스 컴퓨팅은 서버가 존재하지만, 사용자의 운영 개입 없이 클라우드 플랫폼에서 자동으로 관리되는 서비스로, 애플리케이션 함수 실행 서비스 및 백엔드 서비스를 포괄

- 클라우드 서비스 모델
  : 클라우드 서비스는 IaaS, PaaS, SaaS가 일반적으로 제공되는 형태이며, 컨테이너와 서버리스 등의 최신 기술이 발달되면서 CaaS와 FaaS 등 다양한 클라우드 서비스 모델로 세분화되고 있음

### 클라우드 네이티브 특징

- 컨테이너 기술
  - 이식성을 제공
    CaaS(Containers-as-a-Service), "세계 IT를 바꾼 대혁신적 발명품" -> 서비스 개발 및 운영의 현대화

### 클라우드 네이티브 특징

- 작고 가볍고 손쉽게 배포

수 천개 팀 (자율적 DevOps 팀) X 마이크로서비스 아키텍쳐 X 지속적 배포(CD) X 다양한 개발 환경
= 연간 1억 9천만회 배포 (매초 마다 6번의 배포)

- 마이크로 서비스 아키텍쳐 (MSA)
  - 클라우드의 특성과 장점을 적용하여, 클라우드 환경에 최적화된 응용 SW 설계 기법을 정의
  - 탄력적, 선택적 서비스 확장 제공

> API로 통신하는 소규모의 독립적인 서비스로 구성하여, 클라우드 환경에 최적화된 느슨한 결합 (빠른, 신속한, 편리한 업무)

- 모놀리틱 (Monolithic) 단점: 장애 문제, 배포가 무겁다, 무거움, 처리가 어려움, 개발언어 변경 어려움, 느림, 장애문제 처리 어려움, 도태

- 마이크로 서비스 아키텍쳐 (MSA) 장점: 작다, 서비스 중심적, 거미줄, Eventual Consistency, Losely coupled, 빠름, 세분화, 가벼움, 독립

> Auto Scaling 시스템 자원들의 메트릭(Metric) 값을 모니터링하여 서버 사이즈를 자동으로 조절하여 업무 예상치 못한 서비스 부하에 효과적으로 대응

1. 서버 그룹 모니터링 기반 Auto Scaling

- 이벤트 알람 실행시, 가상서버 2대 자동증설
- 그룹 모니터링 이벤트 알림 설정 (예) CPU 사용률 50% 이상으로 5분 이상 지속되면 2대를 증설하는 정책설정

2. 스케쥴링 기반 Auto Scaling

- 가상 서버 2대 자동 증설
- 실행 일정 설정 (예) 오후 8시 서버2대 증설 예약

### CNAPP

- 클라우드 네이티브 애플리케이션 보호 플랫폼 (CNAPP)

* 클라우드 보안 위협을 방지, 검색 및 이에 대응하는 보안 및 규정 준수 기능을 통합하는 올인원 플랫폼 - 가트너, 2021
* 클라우드 네이티브 애플리케이션의 최적의 보안을 위해서는 개발 단계에서 시작하여 런타임 보호로 확장되는 통합적인 보안 접근 방식
* 보안 리더는 보안을 위한 통합 생명 주기 접근 방식을 제공하는 새로운 클라우드 네이티브 애플리케이션 보호 플랫폼(CNAPP)을 고려

- 클라우드 네이티브 보안공격의 위험관리 예시

> Cloud Native Business 의 생성, 저장, 배포, 운영의 전 과정의 가시성 확보 및 위험 관리를 수행해야 합니다.

Asset and risk visibility > Risk reduction with assurance > Runtime visibility > Runtime enforcement

- 전체 DevOps 라이브 사이클에 걸쳐 보안을 제공하는 단일 통합 보안 플랫폼
