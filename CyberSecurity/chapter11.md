# 제 11 장 인증서

#### 2024.06.01.(토)

## 제 1 절 인증서

## 1.1 인증서란 무엇인가?

- 공개 키 인증서(public-key certificate; PKC)

* 이름이나 소속, 메일 주소 등의 개인 정보
* 당사자의 공개 키가 기재
* `인증기관` (CA; Certificate Authority, certifying authority)의 개인 키로 디지털 서명

## 1.2 인증서를 사용하는 시나리오

1.  밥이 키 쌍을 작성한다
2.  밥은 인증기관 트렌트에 자신의 공개 키를 등록한다
3.  인증기관 트렌트는 밥의 공개 키에 자신의 개인 키로 디지털 서명을 해서 인증서를 작성한다
4.  앨리스는 인증기관 트렌트의 디지털 서명이 되어 있는 밥의 공개 키(인증서)를 입수한다
5.  앨리스는 인증기관 트렌트의 공개 키를 사용해서 디지털 서명을 검증하고, 밥의 공개 키가 맞다는 것을 확인한다
6.  앨리스는 밥의 공개 키로 메세지를 암호화해서 밥에게 송신한다
7.  밥은 암호문을 자신의 개인 키로 복호화해서 앨리스의 메세지를 읽는다

## 제 2 절 공인 인증서

## 2.1 공인 인증서 종류

- 범용 공인인증서

  - 모든 분야에서 이용
  - 인터넷뱅킹, 온라인증권, 전자상거래, 전자정부 민원서비스, 4대 사회보험, 국세청 홈텍스, 전자세금계산서, 전자입찰/조달, 온라인 교육, 예비군 등 다양한 분야에서 활용
  - 소정의 수수료

- 용도제한 공인인증서
  - 은행 및 보험, 신용카드 업무, 정부 민원업무 등 특정분야에서만 이용
  - 해당 기관이 고객에게만 발급
  - 무료

## 2.2 인증서의 표준 규격 X.509

- X.509
  - 가장 널리 사용
  - ITU(International Telecommunicatioin Union)나 ISO(International Organization for Standardization)에서 규정한 규격
  - 인증서의 생성 \* 교환을 수행할 때 사용
  - 많은 애플리케이션에서 지원

## 2.5 인증서의 작성

- SSL로 보호된 웹 사이트에서 다음의 정보를 입력하고 인증서를 작성

* 이름: Gil Dong Hong
* 메일 주소: gildong@novel.ac.kr
* 패스워드: xxxxxxxx

### 웹 브라우저에 표시되는 내용

- Organization = KECA, Inc.
- Organizational Unit = CrossCert Class 1 Consumer Individual Subscriber CA
- Organizational Unit = Terms of use at www.crosscert.com/rpa (c)01
- Organizational Unit = Authenticated by CrossCert
- Organizational Unit = Member, VeriSign Trust Network
- Organizational Unit = Persona Not Validated
- Organizational Unit = Digital ID Class 1 - Netscape
- Common Name = Gil Dong Hong
- Email Address = gildong@novel.ac.kr

## 2.6 인증서의 내용

- 특정 소프트웨어를 사용하면 인증서의 내용을 자세히 표시할 수도 있다
  - X.509 인증서 구조
    - 서명 전 인증서
      - 디지털 서명의 대상이 되는 정보
    - 디지털 서명 알고리즘
      - 서명 전 인증서에 서명할 때에 사용하는 알고리즘
    - 디지털 서명 본체
      - 서명 전 인증서에 한 디지털 서명 그 자체

## 제 3 절 공개 키 기반 구조 (PKI)

## 3.1 공개 키 기반 구조 (PKI)

- 공개 키 기반구조(public-key infrastructure)
  - 공개 키를 효과적으로 운용하기 위해 정한 많은 규격이나 선택사양의 총칭
    - PKCS (Public-Key Cryptography Standards)
    - RSA사가 정하고 있는 규격의 집합
    - RFC (Reqeusts for Comments) 중에도 PKI에 관련된 문서
    - 인터넷의 선택사양을 정한다
    - X.509
    - API(Application Programming Interface) 사양서

## 3.2 PKI 구성 요소

- 이용자:
  PKI를 이용하는 사람

- 인증 기관:
  인증서를 발행하는 사람

- 저장소:
  인증서를 보관하고 있는 데이터베이스

### 이용자

- PKI를 사용해서 자신의 공개 키를 등록하고 싶어하는 사람과
- 등록되어 있는 공개 키를 사용하고 싶어 하는 사람

### 이용자가 하는 일

- 키 쌍을 작성한다(인증 기관이 작성하는 경우도 있다)

- 인증 기관에 공개 키를 등록한다

- 인증 기관으로부터 인증서를 발행 받는다

- 필요할 경우 인증 기관에 신청해서 등록한 공개 키를 무효로 한다

- 수신한 암호문을 복호화한다

- 메세지에 디지털 서명을 한다

### 공개키 사용자가 하는 일

- 메세지를 암호화해서 수신자에게 송신한다

- 디지털 서명을 검증한다

### 인증 기관

- 인증 기관(CA; certificate authority)

* 인증서의 관리를 행하는 기관
* 키 쌍을 작성한다(이용자가 작성하는 경우도 있다)
* 공개 키 등록 때 본인을 인증한다
* 인증서를 작성해서 발행한다
* 인증서를 폐지한다

### 등록 기관

- 등록 기관(RA; registration authority)

* 인증 기관의 일 중 [공개 키의 등록과 본인에 대한 인증]을 대행하는 기관

## 3.3 공인 인증기관

- 미래창조과학부 산하에 민간 최상위 인증기관인 한국인터넷진흥원(KISA)이 있음

- 전자서명법 제 4조의 규정에 의해 지정된 공인인증기관은 6개가 있음

  - 개인 또는 기업 등의 요청에 따라 공인인증서를 발급
  - 철저한 심사 절차를 통해 발급
  - 법적 효력과 안정성 보장

- 2022.12.10 공인인증서 폐지 --> 대체안 발표

- 공동인증을 주관하고 있는 기관들
  - 구) 공인인증기관 6곳

| 한국증권전산 | www.signkorea.com | 한국정보사회진흥원 | sign.nia.or.kr |
| 한국정보인증 | www.signgate.com | 한국전자인증 | www.crosscert.com |
| 금융결제원 | www.yessign.com | 한국무역정보통신 | www.tradesign.net |

### 저장소

- 저장소(repository)

* 인증서를 보존해 두고, PKI의 이용자가 인증서를 입수할 수 있도록 한 데이터베이스
* 인증서 디렉토리
* 전화에 있어서 전화번호부와 같은 역할
* 앨리스가 밥의 인증서를 입수할 때 저장소를 이용할 수 있음

## 3.4 인증 기관의 역할

- 키 쌍의 작성

- 인증서 등록

- 인증서 폐지와 CRL

### 키 쌍의 작성

- PKI의 이용자가 작성하기

- 인증 기관이 작성하기
  - [개인 키를 이용자에게 보내는] 추가 업무
    - 방법은 PKCS # 12(Personal Information Exchange Syntax Standard)로 정의

### 인증서 등록

- 이용자는 인증 기관에 인증서 작성을 의뢰

  - 규격은 PKCS #10(Certification Request Syntax Standard) 등으로 정의

- 운용 규격(certification practice statement; CPS)에 근거해서 이용자를 인증하고, 인증서를 작성
  - 인증서 형식은 PCKS #6(Extended-Certificate Syntax Standard)나 X.509로 정의

### 인증서 폐지와 CRL

- 인증서를 폐지(revoke)해야 할 경우

  - 이용자가 개인 키를 분실 혹은 도난

- 인증서 폐지 목록(CRL: certificate revocation list)을 작성

- 인증 기관의 최신 CRL을 조사해서 그 인증서 유효성 확인 필요

## 3.5 계층 구조를 갖는 인증서

회사 내의 사내 PKI

서울 본사(서울 본사 인증기관) -> 충남 지사(충남 지사 인증기관) -> 논산 지점(논산 지점 인증기관)

- 루트 CA

* 최상위 인증 기관

- 셀프 서명(self-signature)

* 자기 자신의 공개 키에 대해서 자신의 개인 키로 서명하는 디지털 서명

### 앨리스가 밥의 바른 공개 키를 얻는 과정

앨리스 [루트 CA가 서명한 충남 지사 인증 기관의 공개 키]

-> (루트 CA의 공개 키) + 서명 검증 -> (충남 지사 인증 기관이 서명한 논산 지점 인증 기관의 공개 키) + 서명 검증
-> + (논산 지점 인증 기관의 공개 키) + (논산 지점 인증 기관이 서명한 밥의 공개 키) + 서명 검증 -> 밥의 공개 키

### 다양한 PKI

- 누구나 인증기관이 될 수 있고 실제로 세계에는 무수히 많은 인증기관이 존재

- 사내 이용 방법

  - 인증기관의 계층을 회사의 조직 계층에 적용
  - 부서별로 PKI 운영하고 상호 인증

- 우리나라 PKI
  - 한국인터넷진흥원 전자서명인증관리센터에서 관리
  - 인증기관의 계층이나, 운용 규약, 공개 키의 등록 \* 인증서 발행 등을 규정

## 제4절 인증서에 대한 공격

## 4.1 공개 키 등록 이전 공격

- 인증 기관이 디지털 서명을 수행하기 이전에 적극적 공격자 맬로리가 공개 키를 자신의 것과 살짝 바꿔치기 한다

- 인증 기관은 [밥의 정보]와 [맬로리의 공개 키]의 조합에 대해 디지털 서명을 하게 된다.

## 4.2 닮은 사람을 등록하는 공격

- 오인하기 쉬운 사용자 정보를 사용

  - Name = Bob 을 Name = BOB 로

- 이 공개 키는 이름은 BOB으로 되어 있지만, 맬로리의 공개 키

- 맬로리는 밥의 행세를 하며 Name = BOB으로 되어 있는 인증서를 앨리스에게 보낸다

## 4.3 인증 기관의 개인 키를 훔쳐내는 방법

- 인증 기관의 개인 키를 훔쳐낸다

- 인증 기관의 개인 키가 도난 당했다면(누설되었다면), 인증 기관은 자신의 키가 누설되었다는 것을 CRL을 사용해서 이용자에게 통지해야 함

## 4.4 공격자 자신이 인증 기관이 되는 공격

- 맬로리 자신이 인증 기관이 된다

- 인증 기관이 된 맬로리는 자신의 공개 키라도 [이것은 밥의 공개 키이다]라고 주장하는 인증서를 자유롭게 발행

- 인증 기관을 신뢰할 수 없으면 인증서가 아무리 바르더라도 그 공개 키를 사용해서는 안된다.

## 4.5 CRL의 허점을 찌르는 공격 1

- 공격자 맬로리는 CRL이 도착하기 전 빠른 공격을 시도

- 방어방법
  - 공개 키가 무효가 되면 가능한 한 빨리 인증 기관에 전한다(밥)
  - CRL은 신속하게 발행한다(트렌트)
  - CRL은 정확히 갱신한다(앨리스)
  - 공개 키를 이용하기 전에는 공개 키가 무효가 되지 않았나를 재확인한다(앨리스)

## 4.6 CRL의 허점을 찌르는 공격 2

1. 밥이 앨리스로부터 돈을 뜯어낼 계획수립
2. 밥은 가명을 써서 계좌 X-5897을 개설
3. 앨리스에게 송금 요청을 하고 자신의 서명을 붙인다
4. 트렌트에게 개인키가 도난 당했다고 보고한다
5. 앨리스에게 CRL이 도착하기 전에 앨리스가 해당 금액을 계좌 X-5897로 송금을 했다면
6. 밥은 예금을 인출한다
7. 앨리스가 나중에 CRL을 받고 밥에게 항의한다
8. 밥은 자신의 개인키가 도난 당했다고 주장하고 돈을 착복한다

## 4.7 Superfish

- 2015년에 PC 벤터 Lenovo사의 컴퓨터에서 중대한 사건이 발생
  - 컴퓨터에 프리인스톨 되어 있던 Superfish라는 애드웨어가 보안 문제를 일으킴
  - 통신을 가로채 개인 정보를 수집하여 사용자의 인터넷 이용 맞춤 광고를 내보내는 소프트웨어
  - 루트 인증서를 인스톨하여 Web 사이트와 Web 브라우저 사이에 들어간 후, 방문한 Web 사이트 인증서를 바꿔치기하여 Web 브라우저에 제시
  - 전형적인 중간자 공격으로 통신 갈취

## 제 5 절 인증서에 대한 Q & A

## 5.1 인증서의 필요성

- 의문: 인증서의 필요성을 모르겠다. 인증기관의 인증서를 사용해서 공개 키를 압수하는 것과, 공개 키만을 받는 것과는 같은 것이 아닌가?

- 답:
  - 신뢰할 수 없는 경로(예를 들면 메일)로 공개 키를 입수하는 경우, 중간자(main-in-the-middle) 공격이 가능해진다.
  - 인증기관으로부터 인증서를 입수하면 중간자 공격(man-in-the-middle attack)의 가능성을 줄일 수 있다.

### 인증 기관의 필요성

- 신뢰할 수 있는 공개 키를 입수할 수 있다면 인증 기관은 불필요하다

- 신뢰할 수 있는 인증 기관의 공개 키를 가지고 있고, 인증 기관의 본인 확인을 신뢰한다면, 그 안증 기관이 발행한 인증서에 의해 입수한 공개 키는 신용할 수 있다.

## 5.2 독자적인 인증 방법을 사용하는 것이 안전한 것이 아닌가?

- 의문: 인증서 형식이든 PKI든 공개되어 있는 기술을 사용하는 것에 불안을 느낀다.

  - 공개되어 있는 기술을 사용한다는 것은 공격자에게 공격을 위한 정보를 제공하는 것이 된다고 생각한다.
  - 그것보다는 사내에서 독자적으로 개발한 비밀 인증 방법을 사용하는 편이 안전하지 않을까?

- 답:
  - 그렇지 않다.
  - 비밀 인증 방법을 독자 개발하는 것은 [감추는 것에 의한 보안] (security by obscurity) 라는 전형적인 잘못이다.

## 5.3 인증 기관을 어떻게 신뢰할 것인가?

- 의문: 인증 기관의 기능은 대강 이해를 했지만, 결국 맴도는 것 같은 느낌이 든다.

  - 공개 키를 신뢰하기 위해서는 인증서를 발행한 인증 기관을 신뢰해야 하는데, 그렇다면 인증 기관은 어떻게 신뢰하는 것일가?

- 답:
  - 이 의문은 정당하다.
  - 이 의문은 [신뢰]가 어떻게 형성되는가 하는 본질적인 문제와 관계되어 있기 때문이다.
  - 정부관련 기관 ?

## 제 6 절 공인 인증서를 대체하는 기술

### 공인 인증서 폐지 배경

- '전자 서명법' 개정에 따라 2020년 12월 10일부로 공인인증서 폐지
- 기존 공인인증서와 민간인증서 모두 '공동 인증서'로 사용됨
- 공인인증서의 독점 지위를 폐지하고, 사설인증서와의 경쟁을 촉발

### 공인 인증서 폐지 이유

갱신과 보관의 불편

- 매년 갱신의 필요와 보관의 불편함

사이트 사용의 복잡

- 사용을 위한 엑티브X 프로그램 설치, 복잡한 과정 진행 등

민간 전자 인증 시장의 발전

- 6개의 공인인증기관만 공인인증서를 발급할 수 있었기 때문에 민간 전자인증 시장 발전 저해 영향

### 공인 인증서를 대체하는 기술

- 공동인증서
  - 기존의 공인인증서가 공동인증서로 변경
  - 기존 6개 공인인증서 발급 기관 발급: 금융결제원, 코스콤(구, 한국증권전산), 한국정보인증, 한국전자인증, 한국전산원, 한국무역정보통신
  - 유효기간: 1~3년
  - 주요 사용처: 금융, 공공기관, 전자거래, 사업자범용(일부)
  - 예)

| 인증서 종류 | 발급기관 | 인증서 유효기간 | 주요 사용처 |
| 금융인증서 | 금융결제원 | 3년 | 금융, 공공기관, 전자거래 |
| 한국전자인증서 | 한국전자인증 | 2년 | 금융, 공공기관, 전자거래 사업자범용 인증서 |

### 금융 인증서

- 기존 공인인증기관인 금융결제원 (금융인증센터) 에서 제공하는 인증서
  https://www.yessign.or.kr

- 기존 공인인증서에 비해 빠르고 편하게 본인 인증이 가능함

- 6자리의 비밀번호 또는 패턴, 지문, 홍채 등의 생체정보를 통해 본인 인증이 가능하며 유효기간은 3년

- 금융, 공공기관, 전자거래 등 대부분의 개인인증서를 필요로 하는 모든 서비스를 지원

### 공인 인증서와 금융 인증서 비교

| 공동인증서 | 구분 | 금융인증서 |
| 6개월 공인인증기관 | 발급기관 | 금융결제원 |
| 사용자 기기 | 보관방식 | 클라우드 서버 |
| 1년 (수동 갱신) | 유효기간 | 3년 (자동 갱신) |
| 영문+숫자+특수문자 혼합 | 비밀번호 | 6자리 숫자 |

### 한국전자인증서

- 기존 공인인증기관인 한국전자인증에서 제공하는 인증서
  https://www.crosscert.com/

- 기존 공인인증서에 비해 빠르고 편하게 본인 인증이 가능함

- 금융, 공공기관, 전자거래 등 대부분의 개인인증서를 필요로 하는 모든 서비스를 지원함

- 사업자 범용 공동인증서 지원

### 민간인증서

| 인증서 종류 | 발급기관 | 인증서 유효기간 | 주요 사용처 |
| 카카오인증서 | 카카오 | 2년 | 일부 금융, 공공기관, 전자거래 |
| 네이버인증서 | 네이버 | 3년 | 세금 납부, 일부 전자거래 |
| PASS 인증서 | 통신 3사 | 3년 | 일부 금융, 공공기관, 전자거래 |
| KB 모바일 인증서 | KB 국민은행 | 기간 없음 | KB 금융 비대면 서비스 |
| 토스 인증서 | 비바리퍼블라카 | 2년 | 일부 금융, 보험 서비스 |
| 페이코인증서 | NHN PAYCO | 2년 | NHN 계열사 서비스, 일부 공공기관 |

### 카카오 인증서

- 카카오페이 기반의 인증서로 카카오톡을 통한 금융, 공공 인증 서비스 제공
- 카카오톡에 공개키 (PKI) 인증 기술 결합, 전자문서 블록체인 연동
- One Time Token, SSL 암호화 통신, Anti-mirroring 등 지원
- 인증서의 유통기한은 2년

`블록체인 연동`, `암호화 통신`, `One Time Token`, `Anti-Mirroring`, `E2E 보안`

### 네이버 인증서

- 네이버앱을 통해 발급받을 수 있는 인증서로, 네이버 회원일 경우 손쉽게 발급 가능

- FIDO (Fast IDentity Online), PKI, 블록체인 등 여러 보안 기술을 적용, 일부 사이트의 경우 네이버 로그인을 통해 인증과정 간소화

- 유효기간은 3년

### FIDO (Fast IDentity Online)

- FIDO Alliance: 온라인 환경에서 바이오인식기술을 활용한 인증방식에 대한 기술표준(De Facto)을 정하기 위해 2012년 7월 설립됨
- 이용자 단말에서의 사용자 로컬 인증과 서비스 제공 기관의 서버에서 수행하는 원격인증을 분리
- 구글, MS, 페이팔, 마스터카드, 레노버, LG 전자 등 90개 업체가 참여하여 활발하게 활동
- FIDO 기술 개념도

### PASS 인증

- PASS 앱 기반 인증서로 SK텔레콤, KT, LG유플러스가 공동 출시
- FIDO, 생체인증, WBC (White-Box Cryptography, 화이트박스 암호) 기반 보안 솔루션 지원
- 본인 인증만 제공하던 PASS 앱에 전자서명 기능을 추가
- 백신, 위변조 방지 등의 보안 기술을 적용
- 빠르게 발급받을 수 있으며, 유효기간은 3년

```
화이트박스 암호: 알고리즘을 큰 룩업테이블로 만들고 그 안에 암호키를 소프트웨어로 구현된 아호 알고리즘과 뒤섞인 상태로 숨겨둠으로써 내부의 동작을 분석하더라도 암호키를 쉽게 유추하지 못하도록 하는 기법
```

### KB 모바일 인증

- KB 국민은행에서 발급하는 모바일 인증으로 국민은행 모바일 서비스에서 활용 가능
- 패턴, 생체인식 기술 및 트러스토닉 애플리케이션 프로텍션(Trustonic Application Protection: TAP) 기술을 적용
- 유효기간이 존재하지 않음

```
TAP: 하드웨어 기반의 TEE와 WBC 기반의 소프트웨어 보호기술을 사용하여 모든 기기(Android 및 iOS) 환경에 적용 가능한 보안 솔루션 - K-SXXX 회사 개발
```

휴대폰 본인인증 -> 신분증 촬영(주민등록증, 운전면허증) -> 계좌인증 -> 비밀번호 등록(패턴, 간편비밀번호 등)

### Toss 인증

- Toss와 한국전자인증 공동으로 운용하는 인증서
- 토스 어플리케이션, 또는 토스 웹사이트에서 핸드폰번호와 생년월일을 사용하여 간편하게 접속 가능
- PIN, 생체인증 기술 및 PKI, FIDO 기술 사용
- 유효 기간은 2년

### 페이코 인증

- NHN 페이코에서 제공하는 인증서
- 패턴, 생체인식, 클라우드 블록체인 기술 적용
- 유효기간은 2년
