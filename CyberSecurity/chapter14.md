# 제 14 장 PGP

#### 2024.06.02.(일)

## 제 1 절 PGP 개요

## 1.1 PGP

- PGP (Pretty Good Privacy)

- 1990년 경에 필립 짐머만(Philip Zimmermann)이 제작
- 현재도 전 세계에서 널리 사용되고 있는 암호 소프트웨어
- Windows, UNIX, Macintosh 등 기타 많은 플랫폼 상에서 작동
- 상업용 또는 프리 소프트웨어용으로 제작
  - 프리 소프트웨어
    - OpenPGP(RFC 4880) 사양에 따라 GNU가 작성한 GnuPG(GNU Privacy Guard)

## 1.2 OpenPGP에 대해

- OpenPGP
  - 암호문이나 디지털 서명 형식을 정한 규격
    - RFC 1991: (1991년) PGP 메세지 형식을 기술
    - RFC2440
    - RFC4880: (2007년) RSA와 DSA를 지원
    - RFC5581
    - RFC6637: (2012년) 타원 곡선 암호(ECC)를 지원
      - Curve P-256, P-384, P-512이라는 3종류의 타원곡선을 사용하여 타원곡선 DSA(Elliptic Curve Digital Signature Algorithm: ECDH)라는 2개의 알고리즘을 지원

### RFC6637

- 암호적으로 강력한 균형을 유지하기 위한 표 제시
  - 예시) 타원 곡선 암호로 256 비트를 선택한 경우 해시로서 256 비트를 선택하고 아직 대칭암호의 키 길이로서 128 비트를 선택

| 타원곡선명 | ECC | RSA | 해시 | 대칭 암호 |
| P-256 | 256 비트 | 3,072 비트 | 256 비트 | 128 비트 |
| P-384 | 384 비트 | 7,680 비트 | 384 비트 | 192 비트 |
| P-521 | 521 비트 | 15,360 비트 | 512 비트 | 256 비트 |

## 1.3 GNU Privacy Guard

- GNU Privacy Guard(GnuPG, GPG)
  - OpenPGP 규격에 따라 만들어진 암호화 소프트웨어
  - 암호화, 디지털 서명, 키 관리, S/MIME와 ssh 등을 지원
  - GNU PGL에 기초한 프리소프트웨어

### GnuPG 버전

- GnuPG stable

  - 버전번호가 2.0. 이기 때문에, OpenPGP, S/MIME, ssh도 지원

- GnuPG modern

  - 버전번호가 2.1. 이기 때문에 stable에 더해서 타원 곡선 암호도 지원
  - GnuPG stable을 대체하는 새로운 버전

- GnuPG classic
  - 버전번호가 1.4.로 구 버전

## 1.4 PGP 기능

- 대칭암호
- 공개 키 암호
- 디지털 서명
- 일방향 해시 함수
- 인증서
- 압축
- 텍스트 데이터
- 큰 파일의 분할과 결합
- 키 고리 관리

### 대칭암호

- 대칭 암호에 의한 암호화와 복호화를 지원

- 대칭 암호 단독이용 가능

- 공개 키 암호와 조합한 하이브리드 암호 시스템의 일부로서 이용 가능

- 사용할 수 있는 대칭 암호 알고리즘

  - AES, IDEA, CAST, 삼중 DES, Blowfish, Twofish

- 블록 암호의 모드:
  - CFB 모드

### 공개 키 암호

- 공개 키 암호의 키 쌍 작성, 공개 키 암호에 의한 암호화와 복호화를 지원

- 하이브리드 암호 시스템을 이용

- 이용할 수 있는 공개 키 암호 알고리즘
  - RSA, ElGamal

### 디지털 서명

- 디지털 서명 작성과 검증을 지원

- 파일에 디지털 서명 첨부

- 파일과 서명 분리

- 이용할 수 있는 디지털 서명 알고리즘
  - RSA, DSA

### 일방향 해시 함수

- 일방향 해시 함수를 이용해서 메세지의 해시 값을 계산하고 표시

- 이용 가능한 일방향 해시 함수 알고리즘
  - MD5, SHA-1, RIPEMD-160

### 인증서

- OpenPGP에서 정해진 형식의 인증서와, X.509 호환용 인증서를 작성

- 공개 키의 취소 증명서(revocation certificate) 발행

### 압축

- 데이터의 압축과 확장

- 압축에 이용되는 형식
  - ZIP

### 텍스트 데이터 변환

- 2진 데이터와 텍스트 데이터의 상호 변환을 수행

- 2진 데이터를 텍스트 데이터(ASCII radix-64 형식)로 변환
  - radix-64 형식
    - 메일 등에서 자주 사용되는 base64 인코딩에 데이터 에러 검출을 위해 검사합을 부가한 것

### 큰 파일의 분할과 결합

- 대 용량 파일을 복수의 파일로 분할하는 기능

- 역으로 복수의 파일을 결합해서 하나의 파일로 결합하는 기능

### 키 고리 관리

- 생성한 자신의 키 쌍이나, 입수한 공개 키를 관리하는 기능
  - 키 링 (key ring) 혹은 키 고리
    - 키를 모아 놓은 파일

## 제 2 절 키 쌍의 작성

## 2.1 GnuPG 1.4.9를 이용한 키 쌍 작성

### 패스 프레이즈 입력 화면

### 공개 키의 예

## 제 3 절 암호화와 복호화

## 3.1 암호화

- 세션 키 생성과 암호화

  1. 의사난수 생성기를 사용해서 세션 키를 생성
  2. 세션 키를 수신자 공개키로 암호화

- 메세지 압축과 암호화
  1. 메세지를 압축
  2. 압축한 메세지를 세션키로 대칭 암호화
  3. 암호화한 세션 키(절차(2))와, 암호화한 메세지(절차(4))를 결합
  4. 절차(5)의 결과를 텍스트 데이터로 변환
  - 변환한 결과가 송신 데이터

## 3.2 복호화

- 송신 데이터를 수신한 수신자가 원래의 메세지를 얻는 과정
  - 개인 키 복호화
  - 세션 키 복호화
  - 메세지의 복호화와 확장

### 개인키 복호화

1. 수신자는 복호화를 위한 패스 프레이즈를 입력
2. 패스 프레이즈의 해시 값을 취해 개인 키를 복호화하기 위한 키를 생성
3. 키 고리 안에 있는 암호화되어 있는 개인 키를 복호화
4. 수신 데이터(텍스트 데이터)를 이진 데이터로 변환
5. 2진 데이터를, 암호화되어 있는 세션 키와 압축 + 암호화되어 있는 메세지로 분해
6. 암호화되어 있는 세션 키를 공개 키 암호로 복호화

- 절차(3)에서 생성한 수신자의 개인 키를 사용한다.

### 메세지 복호화와 확장

7. 절차(5)에서 얻은 압축+암호화되어 있는 메세지를 대칭 암호로 복호화

- 이때 절차(6)에서 생성한 세션 키를 사용

8. 절차(7)에서 얻은 압축 메세지를 확장
9. 이것으로 메세지 획득

## 제 4 절 디지털 서명 작성과 검증

## 4.1 디지털 서명 작성

- 메세지와 그 메세지에 대한 서명을 결합해서 송신 데이터 (텍스트 데이터)로 변환
- 송신 데이터를 텍스트 데이터로 할지 어떨지는 PGP를 사용할 때 선택
- 개인 키 복호화
- 디지털 서명 작성

### 개인 키 복호화

1. 송신자는 서명을 위한 패스 프레이즈를 입력
2. 패스 프레이즈의 해시 값을 취해 개인 키를 복호화하기 위한 키를 생성
3. 키 고리 안에 있는 암호화되어 있는 개인 키를 복호화

### 디지털 서명 작성

4. 일방향 해시 함수를 사용해서 메세지의 해시 값을 계산
5. 절차(4)에서 얻은 해시 값에 서명
6. 절차(5)에서 작성한 디지털 서명과 메세지를 결합
7. 절차(6)의 결과를 압축
8. 절차(7)의 결과를 텍스트 데이터로 변환
9. 절차(8)의 결과가 송신 데이터

## 4.2 디지털 서명 검증

- 작성한 송신 데이터를 수신한 수신자가 원래의 메세지를 얻어 디지털 서명을 검증

- 수신한 해시 값 복원

- 해시 값 비교

### 수신한 해시 값 복원

1. 수신 데이터 (텍스트 데이터)를 2진 데이터로 변환
2. 압축되어 있는 데이터를 확장
3. 신장한 데이터를 서명되어 있는 해시 값과 메세지로 분해
4. 서명되어 있는 해시 값(암호화되어 있는 해시 값)을 송신자의 공개 키를 사용해서 복호화하고, 보내 온 해시 값을 복원

### 해시 값 비교

5. 절차(3)에서 분해한 메세지를 일방향 해시 함수에 부여하여 해시 값을 계산
6. 절차(4)에서 얻은 해시 값과 절차(5)에서 얻은 해시 값을 비교
7. 절차(6)의 결과가 같으면 디지털 서명 검증 성공, 같지 않으면 검증 실패

- 이것이 디지털 서명의 검증 결과

8. 절차(3)에서 분해한 메세지가 송신자의 메세지

## 제 5 절 디지털 서명 작성과 암호화 및 복호화한 디지털 서명 검증

## 5.1 디지털 서명 작성과 암호화

- 디지털 서명 작성

  - 메세지에 대한 디지털 서명 작성

- 암호화
  - 암호화의 대상이 되는 것
    - 메세지
    - 디지털 서명과 메세지를 결합한 데이터

## 5.2 복호화와 디지털 서명 검증

- 복호화

  - 복호화에서 얻어지는 것
    - 메세지
    - 디지털 서명과 메세지를 결합한 데이터

- 디지털 서명 검증
