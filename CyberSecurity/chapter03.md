# Cyber Security 3

# 제 3 장. 암호의 역사

#### 2024.04.14.(일)

## 대칭 암호 모델

- 대칭 암호 방식의 구성 요소

  - 평문(Plaintext)
  - 암호 알고리즘(Encryption algorithm)
  - 비밀키(Secret Key)
  - 암호문(Ciphertext)
  - 복호 알고리즘(Decryption algorithm)

- 암호 시스템은 다음 세가지 영역에 의해 특징화 될 수 있음

  - 평문을 암호문으로 변환하는데 사용되는 동작

    - 치환(substitution)
    - 전치(transposition)

  - 사용한 키의 수

    - Single key: 대칭키/비밀키 암호, 관용 암호
    - Two-key: 비대칭키/공개키 암호

  - 평문이 처리되는 방법
    - 블록 암호
    - 스트림 암호

- 암호 해독(Cryptanalysis) 및 전사적 공격(Brute-Force Attack)

  - 암호 해독

    - 암호 알고리즘 본질에 대한 공격
    - 평문-암호문쌍에 대한 지식 등을 활용한 평문 혹은 키 값 추론

  - 전사적 공격
    - 특정 암호문에 대해 이해할 수 있는 평문으로 전환될 때까지 모든 키에 대해 시도함

- 절대 안정성(Unconditionally Secure) vs 계산상 안정성(Computationally Secure)

  - 절대 안정성

    - 해당 암호 기법으로 생성된 암호문을 아무리 많이 사용하더라도 해당 암호문에 평문을 알아낼 수 있는 충분한 정보를 포함하지 않을 경우 (거의 불가)
    - 예) One-Time Pad
      . 참고) OTP (One Time Password)와 다름

  - 계산상 안정성
    - 아래 두 가지 조건을 만족할 경우
      . 암호 해독 비용이 암호화된 정보의 가치 초과
      . 암호 해독 시간이 정보의 유효 기간 초과

### 스테가노그라피

- 보안기술의 범주

  - 보안(Security): 정보를 보호하는 방법
  - 첩보(Intelligence): 정보를 탐지하는 방법

- 평문메세지의 은닉방법

  - Steganography 방법
    - 메세지의 존재 자체를 은폐
  - cryptography 방법
    - 다양한 원문의 변환에 의해 외부인이 그 의미를 알지 못하도록 메세지를 변형

- 특징
  - 메세지의 존재 자체를 은폐
  - 원문 내의 단어나 문자를 적절히 발췌하여 조합배열 함으로써 실제 메세지를 나타냄

## 제 1 절 시저암호

### 1.1 시저 암호란?

- 시저 암호(Caesar cipher)
  - 줄리어스 시저(유리우스 케사르)가 사용하였다는 암호
  - 평문으로 사용되는 알파벳을 일정한 문자 수만큼 [평행이동] 시킴으로써 암호화

### 1.2 시저 암호의 암호화

![6](/assets/images/2024-04-14/6.png)

### 1.3 시저 암호의 복호화

![7](/assets/images/2024-04-14/7.png)

### 1.4 전사 공격에 의한 해독

- 암호문 NDeVRRQBHH을 보고 다른 정보 없이도 kabsoonyee라는 메세지를 맞출 수는 없을까?

- 영어 알파벳은 26문자이므로 암호화 키는 0에서 25까지 26가지

- 전사 공격(brute-force attack)

  - 키가 될 수 있는 모든 가능한 후보들을 시도해 보는 방법

- 철자의 빈도와 자주 사용되는 단어와 형태를 이용하는 등 전사공격에 취약함

## 제 2 절 단일 치환 암호

### 2.1 단일치환 암호란 무엇인가?

- 단일 치환 암호(simple substitution cipher)
  - 평문을 구성하는 알파벳을 다른 알파벳으로 변환하는 암호
  - 시저 암호는 단일 치환 암호

### 2.2 단일 치환 암호의 암호화

- 약점
  - 평문에 등장하는 문자의 빈도가 암호문으로 바뀐 뒤에도 암호문 내에서 동일한 빈도로 나타난다

### 2.3 단일 치환 암호의 복호화

- 치환표가 단일 치환 암호의 [키]

- 암호화 때에 사용한 치환표가 필요

- 송신자와 수신자는 치환표를 공유

### 2.4 단일 치환 암호의 키 공간

- 시저 암호는 전사 공격으로 해독 가능

- 단일 치환 암호는 전사 공격으로 해독이 어렵다
  - 단일 치환 암호가 시저 암호에 비해 훨씬 많은 키 후보를 가질 수가 있기 때문

### 키 공간

- 키 공간(key space)

  - 해당 암호에서 사용할 수 있는 [모든 키의 집합]
  - 이 키 공간에 속하는 가능한 키의 총수를 키 공간의 크기
  - 키 공간이 크면 클수록 전사공격은 어렵다
  - 단일 치환 암호의 키의 총수

    26 ×25 ×24 ×23 ᆞᆞᆞ 1
    = 403291461126605635584000000

### 전사공격 시간

26 ×25 ×24 ×23 ᆞᆞᆞ 1
= 403291461126605635584000000

- 키 수가 이렇게 많다면
- 1초에 10억 개의 키를 적용하는 속도로 조사한다고 해도, 모든 키를 조사하는 데 120억년 이상의 시간이 필요

### 2.5 빈도 분석에 의한 해독

- 빈도 분석 암호 해석법을 사용하면 단일 치환 암호도 해독할 수 있다

- 빈도 분석에서는
  - 평문에 등장하는 문자의 빈도
  - 암호문에 나오는 문자의 빈도가 일치하는 것을 이용

### 해독작업

- 빈도가 높은 문자뿐만 아니라 빈도가 낮은 문자도 단서가 된다.
- 처음과 끝을 아는 것은 단서가 된다. 단어의 단락을 알면 그것도 단서가 될 수 있다.
- 암호문이 길면 해독이 쉬워진다.
- 같은 문자가 연속해서 나타나면 그것은 단서가 된다.
  - 단일 치환 암호에서는 어떤 문자 어느 문자로 암호화되는지는 정해져 있기 때문
- 해독의 속도가 점점 빨라진다.

## 제 3 절 다중 치환 암호

- 단일 치환암호의 약점

* 평문과 암호문간의 단순 대응을 사용하기 때문에 평문의 단일 문자에 대한 빈도가 그대로 암호문에 반영된다.

- 따라서 암호해독자로 하여금 빈도분석을 어렵게 하기 위해서는 암호문에 나타나는 문자들의 빈도를 거의 균등하게 만드는 암호를 이용하는 것이 바람직하다.
  -> 다중 치환을 이용하여 문자의 발생빈도를 균일화한다.

### 3.1 빈도 분석이 가능한가?

- 빈도분석이 가능했던 이유는 평문에 등장하는 문자의 빈도와 암호문에 등장하는 문자의 빈도가 일치하기 때문

- 다중치환암호(polyalphabetic substitution cipher)
  - 평문에 등장하는 문자의 빈도와 암호문에 등장하는 문자의 빈도를 다르게 만드는 암호 알고리즘
  - 힐암호
  - 비장느르 암호 / 비제네르 (Vigenere) 암호
  - 에니그마 기계(Enigma machine)
  - 빈도분석을 이용한 공격방법이 무용지물

### 치환 기법

- Hill 암호 기법
  - 각 문자에 정수 값을 부여하고 m개의 문자를 치환
    - M=3 개는 3개의 문자를 치환하는 방법

C1 = (k11 p1 + k12 p2 + k12 p3) mod 26
C2 = (k21 p1 + k22 p2 + k23 p3) mod 26
C3 = (k32 p1 + k32 p2 + k33 p3) mod 26

C: 암호문
P: 평문
k: 키

- 암호문 형식을 열 벡터와 행렬로 표현

| C1 | | K11 K12 K33 | | P1 |
| C2 | = | K21 K22 K23 | | P2 |
| C3 | | K31 K32 K33 | | P3 |

- 암호화 사례
  - 평문: PAYMOREMONEY
  - 암호 키
    | 17 17 5 |
    K = | 21 18 21|
    | 2 2 19|

![8](/assets/images/2024-04-14/8.png)

![9](/assets/images/2024-04-14/9.png)

- 다중 단일 문자 치환 암호 기법

  - 관련된 단일 문자 치환 규칙들의 집합을 사용함
  - 주어진 변환에 사용될 특정 규칙은 키에 의해 결정됨

- 대표적인 Vigenere 암호 방식
  - 행렬표를 구성
  - 키 문자 x와 평문자 y가 주어지면 암호 문자는 x행 y열의 암호문 V
  - 키: deceptive
  - 평문: we are discovered save yourself
  - 암호화

![10](/assets/images/2024-04-14/10.png)

## 제 4 절 에니그마

### 4.1 에니그마란 무엇인가?

- 에니그마(enigma)
  - 독일의 세르비우스(Arthur Scherbius)가 20세기 초에 발명한 암호화/복호화를 수행하는 기계
  - 에니그마는 독일어로 [수수께끼]를 의미
  - 회전하는 원반과 전기회로를 써서 강력한 암호를 만들고자 시도
  - 발병 당시에는 에니그마를 상용으로 사용
  - 나치 독일 시대에는 군용으로 사용하려고 개량

![11](/assets/images/2024-04-14/11.png)

### 4.2 에니그마에 의한 암호 통신

- 타이프라이터, 톱니바퀴, 전지, 전구를 조합한 기계
- 암호화와 복호화를 한 대의 기계로 수행
- 송신자와 수신자는 각각 에니그마를 한 대씩 소유

### 코드북과 코드북의 내부

코드북에는 송/수신자가 사용하는 날짜별 키가 기록되어 있고, 송신자/수신자는 이 책자의 지시에 따라 에니그마를 설정

### 4.3 에니그마의 구조

- 에니그마는 알파벳 26 문자를 암호화/복호화할 수 있지만, 그림이 복잡하기 떄문에 여기서는 알파벳의 수를 4문자로 가정

![12](/assets/images/2024-04-14/12.png)

### 로터

- 로터(rotor)
  - 로터는 앞과 뒤의 단자가 전선으로 연결되어 있는 원반 모양의 부품
  - 로터 하나하나의 연결선은 바꿀 수는 없지만, 문자를 입력할 때마다 자동으로 회전
  - 하나의 문자를 입력하면 로터1이 1/4 회전한다(알파벳의 수를 4 문자로 했을 경우). 로터1이 1회전 하면 로터2가 1/4 회전하고, 로터2가 1회전하면 로터3이 1/4 회전.

![13](/assets/images/2024-04-14/13.png)

### 4.4 에니그마 암호화

- 평문: secretletter 를 암호화하여 송신하기
  - 에니그마 설정
  - 통신키의 암호화
  - 암호화된 통신키 메모
  - 에니그마의 재설정
  - 메세지의 암호화
  - 결합

### 4.5 날짜별 키와 통신 키

- 날짜별 키는 메세지의 암호화가 아니라 통신키의 암호화에 사용

- 날짜별 키는 [키를 암호화하기 위한 키]

  - 이와 같은 키를 키 암호 키(key encrypting key; KEK)라 한다

- 메세지를 통신키로 암호화하고, 통신키를 날짜별 키로 암호화하는 2단 구조

### 4.6 통신 오류의 회피

- 통신키 uat를 2회 연속해서 uatuat라고 입력

- 당시 무선 기술수준이 낮아서 통신이 제대로 되지 않는 경우가 많이 있었기 때문

![14](/assets/images/2024-04-14/14.png)

### 4.8 에니그마의 약점

- [통신키를 2회 반복한 것을 암호화한다]
- [통신키를 선택한 것이 사람이다]
- [코드북을 배송하지 않으면 안된다]

### 4.9 에니그마의 해독

- 에니그마의 설계는 [숨기는 것에 의한 보안] (security by obscurity)에 의존하지 않음

- 폴란드의 암호 해독자 르예프스키

  - 날짜별 키에 의한 암호문으로부터 날짜별 키를 간파하는 방법을 고안

- 영국의 암호 해독팀은 블레츨리 파크에 모여 에니그마를 해독

## 제 5 절 전치 암호와 치환 암호

### 5.1 전치 암호

- 전치 암호(transposition cipher)
  - 전치란 평문에서 사용하는 문자의 집합과 암호문에서 사용하는 문자의 집합이 동일
  - 문자집합 내부에서 [자리를 바꾸는 규칙]
  - 평문에 사용된 문자와 암호문에 사용된 문자가 일대일 대응 규칙
  - 시저 암호

### 5.2 치환 암호

- 치환 암호(substitution cipher)
  - 치환 암호의 엄밀한 의미는 평문에서 사용하는 문자의 집합과 암호문에서 사용하는 집합이 다를 수 있다
  - 평문 문자를 다른 문자로 [교환하는 규칙]
  - 교환규칙이 일대일 대응이 아니어도 무방
  - 비장느르 암호
  - 모든 전치 암호는 치환 암호

## 제 6 절 암호 알고리즘과 키

### 6.1 암호 알고리즘과 키를 분리하는 이유

- 암호알고리즘과 키의 조합을 분석
  .알고리즘내의 변경 가능한 부분이 반드시 포함 -> 키

- 암호알고리즘과 키를 반복해서 사용하면?
  .해독 가능성?
  .변경가능한 부분을 미리 준비해두고 사용시 매번 바꾸는 것이 바람직

### [암호 알고리즘]과 [키]를 분리

- 키는 매회 변경한다
- 암호 알고리즘은 반복해서 사용한다

[암호 알고리즘]과 [키]를 분리하여 생각한다.

- 키는 비밀 중에서 가장 중요
- 암호기술에서 키의 관리가 매우 중요
